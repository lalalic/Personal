<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Super Nai Ba</title>
	<link rel="stylesheet" href="res/lungo.css">
	<link rel="stylesheet" href="res/lungo.icon.css">
	<link rel="stylesheet" href="res/lungo.theme.css">
	<style>
		#show img{margin-left: auto;margin-right:auto;display:block}
		[contenteditable=true]{background-color:white;height:100%;padding:10px}
		.outview{position:absolute;top:-9999px;height:1px}
		nav img{width:32px;height:32px}
		.editor{-webkit-user-select:text;-moz-user-select:text;user-select:text;overflow-y: auto}
		.editor img{clear:both;width:150px;margin:5px auto;display:block;cursor:default;border:2px solid transparent}
		.editor img:hover{border-color:blue}
		#taskOption{padding:5px; line-height:3em;cursor:default;list-style:none}
		.favorited, .tasked{color:yellow}
		.stat{position:relative;height:300px;background-color:black}
		.doing{-webkit-animation:rotatingLoader 600ms infinite linear;moz-animation:rotatingLoader 600ms infinite linear}
	</style>
	<script src="res/quo.debug.js"></script>
	<script src="res/mustache.js"></script>
	<script src="res/parse-1.2.8.min.js"></script>
	<script src="res/me.js"></script>
</head>
<body>
	<aside id="userAside">
		<article id="userAside1" class="list active">
			<ul>
				<script type="text/tmpl" id="tmplChildren">
					{{#loop}}
					<li class="thumb" id="tmplChildren_{{id}}">
						<img src="{{attributes.photo._url}}">
						<div>
							<a href="#" data-view-section="child" onmouseup="$(this).trigger('touchend')"  ontouchend="runtime.child={id:'{{id}}'}">{{attributes.name}}</a>
						</div>
					</li>
					{{/loop}}
					{{^loop}}
					<li class="empty">
						<a href="#" data-icon="plus-sign" data-view-section="child" onmouseup="$(this).trigger('touchend')"  ontouchend="runtime.child=null">快快加入你的宝宝和TA一起玩</a>
					</li>
					{{/loop}}
				</script>
			</ul>
		</article>
		<footer>
			<nav>
				<a href="#" data-icon="signout" onclick="Parse.User.logOut();location.reload()"></a>
				<a href="#" data-icon="plus-sign" data-view-section="child" onmouseup="$(this).trigger('touchend')"  ontouchend="runtime.child=null"></a>
			</nav>
		</footer>
	</aside>
	<section id="home" data-transition="slide" data-aside="userAside">
		<header data-title="SNB">
			<nav>
				<a href="#" data-view-aside="userAside" class="on-left" data-icon="left-sign"></a>
				<a data-icon="refresh" class="on-right"></a>
			</nav>
		</header>
		<article id="categories" class="list scroll indented" data-on-load="Parse.find('tag','category','category',tmplCate)">
			<ul>
				<li>
					<div class="stat"></div>
				</li>			
				<script type="text/tmpl" id="tmplCate">
				{{#loop}}
				<li class="thumb">
					<img src="{{attributes.thumbnail._url}}">
					<div>
						<strong><a data-view-section="category" onmouseup="$(this).trigger('touchend')" ontouchend="runtime.cat={name:'{{attributes.name}}',id:'{{id}}'}" href="#">{{attributes.name}}</a></strong>
						<small>{{attributes.desc}}</small>
						<a class="on-right" data-view-section="creator" 
							onmouseup="$(this).trigger('touchend')" 
							ontouchend="runtime.cat={name:'{{attributes.name}}',id:'{{id}}'}" 
							style="font-family:lungojsicon;cursor:pointer">&#xf067;</a>
					</div>
				</li>
				{{/loop}}
				</script>
			</ul>
		</article>
		<footer>
			<nav>
				<a href="#" data-icon="share"></a>
				<a href="#" data-icon="star" data-view-section="favorite"></a>
				<a href="#" data-icon="list" data-view-section="task"></a>
			</nav>
		</footer>
	</section>
	<section id="category" data-transition="slide">
		<header data-back="left-sign" data-title="Posts In Category">
			<nav>
				<a data-icon="refresh" class="on-right"></a>
			</nav>
		</header>
		<article id="posts" class="list scroll" data-on-load="setTitle(runtime.cat.name);Parse.find('post','category',runtime.cat.name,tmplPosts)">
			<ul>
				<li>
					<div style="position:relative;height:300px;background-color:black"></div>
				</li>
				<script type="text/tmpl" id="tmplPosts">
				{{#loop}}
				<li class="thumb">
					<img src="{{attributes.thumbnail._url}}">
					<div>
						<strong><a data-view-section="post" onmouseup="$(this).trigger('touchend')"  ontouchend="runtime.post={id:'{{id}}'}" href="#">{{attributes.title}}</a></strong>
						<a href="#" data-icon="comment" class="on-right" data-count="{{attributes.comments}}"></a>
						<a href="#" data-icon="star" class="on-right" data-count="{{attributes.comments}}"></a>
						<a href="#" data-icon="list" class="on-right" data-count="{{attributes.comments}}"></a>
					</div>
					
				</li>
				{{/loop}}
				</script>
			</ul>
		</article>
		<footer>
			<nav>
				<a data-icon="plus" data-view-section="creator"></a>
				<a data-icon="share" data-view-section="creator"></a>
			</nav>
		</footer>
	</section>
	<section id="post" data-transition="slide">
		<header data-back="left-sign" data-title="loading">
			<nav>
				<a data-icon="refresh" class="on-right"></a>
			</nav>
		</header>
		<article id="show" class="scroll" data-on-load="Parse.get('post',runtime.post.id).then(showPost,Parse.error)">
			<div style="padding:5px">
				<script type="text/tmpl" id="tmplPost">
					<div>
						<div style="min-height:50%">
							<div><span class="on-right"><a data-icon="user">{{attributes.authorName}}</a><span>{{age}}</span></span></div>
							<p>{{{attributes.content}}}</p>
						</div>
						<ul class="list" id="stories"/>
					</div>
				</script>
				<script type="text/tmpl" id="tmplStory" data-target="#stories">
					{{#loop}}
					<li class="thumb">
						<img src="{{attributes.thumbnail._url}}">
						<p>{{{attributes.content}}}</p>
					</li>
					{{/loop}}
					{{^loop}}
					<li class="empty">
						create first story!
					</li>
					{{/loop}}
				</script>
			</div>
		</article>
		<footer>
			<nav>
				<a data-icon="comment" data-view-section="comment" href="#"></a>
				<a data-icon="film" data-view-section="story" href="#"></a>
				<a data-icon="share" data-view-section="comment" href="#"></a>
				<a data-icon="star" id="cmdfavorite" onclick="toggleFavorite()" href="#"></a>
				<a data-icon="menu" id="cmdtask" onclick="popup(taskOption,event)" href="#"></a>
			</nav>
		</footer>
		<ul id="taskOption" class="popup">
			<li><input type="radio" name="taskOption" value=1 onclick="addTask(this,1)">Today</li>	
			<li><input type="radio" name="taskOption" value=2 onclick="addTask(this,2)">Tomorrow</li>
			<li><input type="radio" name="taskOption" value=3 onclick="addTask(this,3)">This week</li>
			<li><input type="radio" name="taskOption" value=4 onclick="addTask(this,4)">This month</li>
			<li><input type="radio" name="taskOption" value=5 onclick="addTask(this,5)">This year</li>
			<li><input type="radio" name="taskOption" value=0 checked onclick="this.checked&&_task(function(t){t&&$(cmdtask).removeClass('tasked')&&t.destroy();done()})">No Plan</li>
		</ul>
	</section>
	<section id="favorite" data-transition="slide">
		<header data-title="My Favorites" data-back="left-sign">
			<nav>
				<a data-icon="refresh" class="on-right"></a>
			</nav>
		</header>
		<article id="favorite1" class="list scroll" data-on-load="Parse.find('favorite','author',Parse.user().id,tmplFavorite)">
			<ul>
				<script type="text/tmpl" id="tmplFavorite">
				{{#loop}}
				<li class="thumb arrow">
					<img src="{{attributes.thumbnail._url}}">
					<div>
						<strong><a data-view-section="post" onmouseup="$(this).trigger('touchend')"  ontouchend="runtime.post={id:'{{post}}'}" href="#">{{attributes.title}}</a></strong>
					</div>
				</li>
				{{/loop}}
				</script>
			</ul>
		</article>
	</section>
	<section id="task" data-transition="slide">
		<header data-title="My Tasks" data-back="left-sign">
			<nav>
				<a data-icon="refresh" class="on-right"></a>
			</nav>
		</header>
		<article id="task1" class="list scroll" data-on-load="Parse.find('favorite','author',Parse.user().id,tmplTask)">
			<ul>
				<script type="text/tmpl" id="tmplTask">
				{{#loop}}
				<li class="thumb arrow">
					<img src="{{attributes.thumbnail._url}}">
					<div>
						<strong><a data-view-section="post" onmouseup="$(this).trigger('touchend')"  ontouchend="runtime.post={id:'{{post}}'}" href="#">{{attributes.title}}</a></strong>
					</div>
				</li>
				{{/loop}}
				</script>
			</ul>
		</article>
	</section>
	<section id="comment" data-transition="slide">
		<header data-title="Comment" data-back="left-sign">
			<nav>
				<a data-icon="refresh" class="on-right"></a>
			</nav>
		</header>
		<article class="list scroll" id="showComments" data-on-load="Parse.find('comment','post',runtime.post,tmplComment)">
			<ul>
				<script type="text/tmpl" id="tmplComment">
				{{#loop}}
					<li class="thumb">
						<a href="#" data-icon="user"><br>{{attributes.authorName}}</a>
						<div>
							<p>{{{attributes.content}}}</p>
							<span class="on-right">{{ago}}</span>
						</div>
					</li>
				{{/loop}}
				</script>
			</ul>
		</article>
		<footer>
			<nav>
				<a><form id="commentCreator"
					onsubmit="this.object('comment','post',runtime.post).save().then(function(c){tmplComment.build({loop:[c]});commentCreator.content.value='';done()},Parse.error);return false;">
					<textarea style="height:46px;padding:5px;width:100%;margin:0" name="content"></textarea>
				</form></a>
				<button data-icon="save" type="submit" form="commentCreator"></button>
			</nav>
		</footer>
	</section>
	
	<section id="creator" data-transition="slide">
		<header data-title="Create Post" data-back="left-sign">
			<nav>
				<button class="on-right" type="submit" form="postCreator" data-icon="save"></button>
			</nav>
		</header>
		<article id="createPost"
			data-on-load="setTitle('Create A '+runtime.cat.name);new Editor(postEditor);Parse.find('tag','category','goal',function(o){tmplCheckable.build({loop:o},'#tags')})">
			<form id="postCreator" onsubmit="savePost(this);return false">
				<fieldset><input type="text" placeholder="title" name="title"></fieldset>
				<fieldset><div name="content" id="postEditor" class="editor" contenteditable="true">content</div></fieldset>
				<fieldset>
					<label>Gender</label>
					<select name="tags" multiple="multiple">
						<option value="N5zSTzoczQ">Boy</option>
						<option value="DJIUvgiFpk">Girl</option>
					</select>
				</fieldset>
				<fieldset>
					<select name="duration">
						<option value="KknqyCi9x2">60</option>
						<option value="ueOPMH3mSR">10</option>
						<option value="MNWQyARcTj">30</option>
						<option value="xWiqWf3msh">45</option>
						<option value="4NZdgfvDpV">90</option>
						<option value="5BqICFnfKY">120</option>
					</select>
				</fieldset>
				<input type="submit" class="outview">
			</form>
		</article>
		<footer>
			<nav>
				<a data-icon="picture" onclick="postEditor.insertImage()"></a>
				<a data-icon="trash" onclick=""></a>
				<a data-icon="dashboard" onclick="popup(tags,event)"></a>
			</nav>
		</footer>
		<div class="popup" id="tags" onclick="event.stopPropagation()"></div>
	</section>
	<section id="story" data-transition="slide">
		<header data-back="left-sign" data-title="Create Story">
			<nav>
				<button class="on-right" type="submit" form="storyForm" data-icon="save"></button>
			</nav>
		</header>
		<article id="createStory">
			<form id="storyForm" onsubmit="this.object('story','post',runtime.post.id,'duration', parseInt(p.duration.text())).save().then(Lungo.Rounter.back,Parse.error);return false">
				<fieldset><select name="duration">
							<option value="KknqyCi9x2">60</option>
							<option value="ueOPMH3mSR">10</option>
							<option value="MNWQyARcTj">30</option>
							<option value="xWiqWf3msh">45</option>
							<option value="4NZdgfvDpV">90</option>
							<option value="5BqICFnfKY">120</option>
						</select>
				</fieldset>
				<fieldset><textarea placeholder="content" name="content"></textarea></fieldset>
			</form>
		</article>
		<footer>
			<nav>
				<a data-icon="picture" onclick=""></a>
				<a data-icon="minus" onclick=""></a>
			</nav>
		</footer>	
	</section>	
	
	<section id="user" data-transition="slide">
		<header data-back="left-sign" data-title="User Account"></header>
		<nav data-control="groupbar">
			<a href="#" data-view-article="signin" data-title="Sign In">Sign In</a>
			<a href="#" data-view-article="signup" data-title="Sign up">Sign Up</a>
			<a href="#" data-view-article="forgetpassword" data-title="Forget Password">Forget Password</a>
		</nav>
		<article id="signin">
			<form onsubmit="this.object(new Parse.User()).logIn().then(Lungo.Router.back,Parse.error);return false">
				<fieldset><input name="username" type="text" placeholder="user name"></fieldset>
				<fieldset><input name="password" type="password" placeholder="password"></fieldset>
				<fieldset class="outview"><input type="submit"></fieldset>
			</form>
		</article>
		<article id="signup">
			<form onsubmit="this.object(new Parse.User()).signUp().then(Lungo.Router.back,Parse.error);return false">
				<fieldset><input name="username" type="text" placeholder="user name"></fieldset>
				<fieldset><input name="email" type="email" placeholder="email where reset password will be sent"></fieldset>
				<fieldset><input name="password" type="text" placeholder="password"></fieldset>
				<fieldset class="outview"><input type="submit"></fieldset>
			</form>
		</article>
		<article id="forgetpassword">
			<form onsubmit="Parse.User.requestPasswordReset(this.email.value);return false">
				<fieldset><input name="email" type="text" placeholder="email where new password would send"></fieldset>
				<fieldset class="outview"><input type="submit"></fieldset>
			</form>
		</article>			
		<footer>
			<nav>
				<a data-icon="ok-sign" onclick="form().submit()"></a>
			</nav>	
		</footer>
	</section>
	<section id="child" data-transition="slide">
		<header data-back="left-sign" data-title="baby"></header>
		<article id="child1" data-on-load="runtime.child&&Parse.get('child',runtime.child.id).then(function(c,d){(d=childForm).set(c);d.photo.value&&(d.photo.src=d.photo.value.url())},Parse.error)||this.set()">
			<form id="childForm" 
				onsubmit="this.object('child','gender',parseInt(this.gender.value)).save().then(function(c){tmplChildren.build({loop:[c]});Lungo.Router.back();},Parse.error);return false">
				<input type="hidden" name="id">
				<fieldset><input type="text" name="name" placeholder="baby name"></fieldset>
				<fieldset>
					<select name="gender">
						<option value=0>Boy</option>
						<option value=1>Girl</option>
					</select>
				</fieldset>
				<fieldset><input type="date" name="birthday" placeholder="birthday"></fieldset>
				<fieldset>
					<img name="photo" onclick="uploader.bind(this).click()" 
						style="width:150px;height:150px;border:1px solid;background-color:lightgray;display:block;margin:0px auto" 
						placeholder="photo"/>
				</fieldset>
				<fieldset class="outview"><input type="submit"></fieldset>
			</form>
		</article>
		<footer>
			<nav>
				<a data-icon="certificate" onclick="runtime.child=extracChild()"></a>
				<a><button type="submit" form="childForm" data-icon="ok-sign"></button></a>
			</nav>
		</footer>
	</section>
	<input type="file" id="uploader" class="outview" onchange="this.save()">
	<canvas id="_imgSizer" class="outview"></canvas>
	<script type="text/tmpl" id="tmplCheckable">
		<div class="checkable">
			<span>{{title}}</span>
			{{#loop}}
			<span><input type="{{type}}" name="{{name}}" value="{{id}}"class="outview">{{attributes.name}}</span>
			{{/loop}}
		</div>
	</script>	
	<script src="res/lungo.debug.js"></script>		
	<script>init()</script>

 </body>
</html>
