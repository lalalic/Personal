<#--
show:
    -showList
        -action4List, filter4List
        -vote, authorInfo
    -show1 (show1Fields[, show1Extra])
    -showSerial
post:
    -postForm (postFields)
-->
<#macro init>
    <#assign this={"model":"post","path":path}>
</#macro>

<#macro showList>
	<#assign footerNavMacro='action4List' titleContent=this.model>
	<@_tmpl key="showList"><#noparse>
	<ol class="list">
		{{#empty}}<li><div  class="info">没有呢</div></li>{{/empty}}
		{{#posts}}
			<li class="arrow"><a href="/{{path}}/show/{{ID}}.shtml">{{title}}</a></li>
		{{/posts}}
	</ol>
	</#noparse></@>
	<@_data key="showList">
		data={empty:${posts?size}==0,path:"${path}",posts:[<#list posts as p>{ID:"${p.ID}",title:"${p.title}"},</#list>]};
	</@>
</#macro>

<#macro action4List>
	<a data-icon="plus" href="/${path}/create.html">创建</a>
	<a data-icon="search" href="/${path}/">查询</a>
</#macro>

<#macro show1>
	<#assign footerNavMacro={'name':'action41','arg':post}>
	<div>
		<div><@checkbox "tags:" "tag" website.tagger.list(post.attrs)/> <@authorInfo post.author/></div>
		<div data-control="carousel"><div>${post.content}</div></div>
	</div>
	<@show1Extra post/>
</#macro>

<#macro show1Extra post>
</#macro>

<#macro action41 post>
	<a data-icon="pencil" class="small" href="/comment/list/${post.ID}.html"></a>
	<a data-icon="left" href="javascript:void(0)" onclick="$1('[data-control=carousel]').slides.prev()">step</a>
	<a data-icon="right" href="javascript:void(0)" onclick="$1('[data-control=carousel]').slides.next()">step</a>
	<@favoriteCMD post/>
	<a data-icon="share" href="#"></a>
</#macro>

<#macro favoriteCMD post>
	<a data-icon="star" data-count="${post.favorites}" href="#"
		onclick="var a=this;x('get','/${path}/favorite/${post.ID}',function(x){$1('.count',a).innerHTML=x.responseText})"></a>
</#macro>

<#macro postForm>
	<#assign footerNavMacro='postFooterNav' titleContent=titleContent+' '+this.model>
	<form action="/${path}/post" method="post">
		<input type="hidden" name="parent" value="${post.parent!0}">
        <input type="hidden" name="ID" value="${post.ID!0}">
        <input type="submit" class="unvisible">
        <@postFields post/>
	</form>
</#macro>

<#macro postFooterNav>
	<a data-icon="left" href="javascript:void(0)" onclick="editor.slides.prev()"></a>
	<a data-icon="right" href="javascript:void(0)" onclick="editor.slides.next()"></a>
	<a data-icon="camera" href="javascript:void(0)" onclick="editor.slides.add()"></a>
	<a data-icon="remove" href="javascript:void(0)" onclick="editor.slides.remove()"></a>
	<a data-icon="upload" href="#" onclick="$1('.active form input[type=submit]').click()">保存</a>
</#macro>

<#macro postFields post>
	<fieldset>
		<input placeholder="${this.model}标题" type="text" name="title" value="${post.title!}" required="required" style="text-align:center"/>
	</fieldset>
	<#nested/>
	<@postFieldContent post/>
	<fieldset>
		<input type="text" placeholder="标签: 11个月,身体协调" name="tag" value="${post.tag!}">
	</fieldset>
</#macro>

<#macro postFieldContent post>
	<@editor "content" post.content!""/>
</#macro>

<#macro authorInfo userID>
</#macro>

<#macro showPostTags tags>
	
</#macro>
