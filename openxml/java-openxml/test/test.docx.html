<HTML>
    <Head>
        <Style>
            <!--
p{}
p span{font-size:10pt;}
.Heading1{}
.Heading1 span{font-size:18pt;}
.Heading2{}
.Heading2 span{font-size:15pt;}
.Heading3{}
.Heading3 span{font-size:12pt;}
.Heading4{}
.Heading4 span{font-size:11pt;}
.Heading5{}
.Heading5 span{font-size:12pt;}
.Heading6{}
.Heading6 span{}
.Heading7{}
.Heading7 span{}
.Heading8{}
.Heading8 span{font-size:10pt;}
.Heading9{}
.Heading9 span{font-size:14pt;}
span{}
table{}
.NoList{}
.Heading1Char{font-size:18pt;}
.Heading2Char{font-size:15pt;}
.Heading3Char{font-size:12pt;}
.Heading4Char{font-size:11pt;}
.Heading5Char{font-size:12pt;}
.Heading6Char{}
.Heading7Char{font-size:10pt;}
.Heading8Char{font-size:10pt;}
.Heading9Char{font-size:14pt;}
.BalloonText{}
.BalloonText span{font-size:8pt;}
.BalloonTextChar{font-size:8pt;}
.Title{}
.Title span{font-size:24pt;}
.TitleChar{font-size:26pt;}
.Header{}
.HeaderChar{}
.Footer{}
.Footer span{font-size:9pt;}
.FooterChar{font-size:9pt;}
.ListBullet{}
.ListNumber{}
.TOC4{}
.TOC5{}
.BodyText{}
.BodyTextChar{font-size:10pt;}
.TableGrid{font-size:10pt;}
.BodyText3{}
.BodyText3 span{font-size:10pt;}
.BodyText3Char{font-size:8pt;}
.ListNumber2{}
.Hyperlink{}
.TableofFigures{}
.TableofFigures span{}
.TOC1{}
.TOC1 span{}
.TOC2{}
.TOC2 span{}
.TOC3{}
.TOC3 span{font-size:10pt;}
.TOCHeading1{}
.TOCHeading1 span{font-size:14pt;}
.TitlePagesubheadercontent{}
.TitlePagesubheadercontent span{font-size:10pt;}
.Strong{}
.TOCHeading10{}
.TOCHeading10 span{font-size:14pt;}
.SubtleReference{}
.PlaceholderText{}
.ContentControl{font-size:11pt;}
.Companyname{}
.Companyname span{}
.TitleSubheaderbold{}
.TitleSubheaderbold span{font-size:10pt;}
.TitleSubheader{}
.TitleSubheader span{}
.FooterPageNumber{}
.FooterPageNumber span{font-size:8pt;}
.ListParagraph{}
.ListParagraph span{font-size:10pt;}
.NoSpacing{}
.NoSpacing span{font-size:10pt;}
.LightShading-Accent11{font-size:10pt;}
.CommentReference{font-size:8pt;}
.CommentText{}
.CommentText span{font-size:10pt;}
.CommentTextChar{font-size:10pt;}
.CommentSubject{}
.CommentSubject span{}
.CommentSubjectChar{font-size:10pt;}
.Revision{}
.Revision span{font-size:10pt;}
.NormalWeb{}
.NormalWeb span{font-size:12pt;}
.Paragraphtext{}
.Paragraphtext span{font-size:10pt;}
.FollowedHyperlink{}
.Subtitle{}
.Subtitle span{font-size:12pt;}
.SubtitleChar{font-size:12pt;}
-->
        </Style>
    </Head>
    <P/>
    <P/>
    <P/>
    <Table>
        <Tr>
            <Td>
                <P>
                    <span>EMC On</span>
                    <span>Demand </span>
                    <span>vApp</span>
                    <span> Construction Guide</span>
                </P>
            </Td>
            <Td>
                <P/>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P/>
            </Td>
            <Td>
                <P/>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P/>
            </Td>
            <Td>
                <P/>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>Modified date:</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span/>
                    <span/>
                    <span/>
                    <span>October 8, 2012</span>
                    <span/>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P/>
                <P>
                    <span>Version:</span>
                </P>
            </Td>
            <Td>
                <P/>
                <P>
                    <span>1.7</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P/>
            </Td>
            <Td>
                <P/>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P/>
            </Td>
            <Td>
                <P/>
            </Td>
        </Tr>
    </Table>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>Table of Contents</span>
    </P>
    <P>
        <span/>
        <span/>
        <span/>
        <span>1</span>
        <span/>
        <span>Overview</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>4</span>
        <span/>
    </P>
    <P>
        <span>2</span>
        <span/>
        <span>VCUBE Terminology</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>5</span>
        <span/>
    </P>
    <P>
        <span>3</span>
        <span/>
        <span>Infrastructure Guide</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>8</span>
        <span/>
    </P>
    <P>
        <span>3.1</span>
        <span/>
        <span>Hardware and Virtual Infrastructure Environment</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>8</span>
        <span/>
    </P>
    <P>
        <span>3.2</span>
        <span/>
        <span>Managed Server VMs</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>8</span>
        <span/>
    </P>
    <P>
        <span>3.3</span>
        <span/>
        <span>Managed Desktops</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>10</span>
        <span/>
    </P>
    <P>
        <span>4</span>
        <span/>
        <span>VM Naming Guide</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>12</span>
        <span/>
    </P>
    <P>
        <span>4.1</span>
        <span/>
        <span>Server Name Requirements</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>12</span>
        <span/>
    </P>
    <P>
        <span>4.2</span>
        <span/>
        <span>Desktop Name Requirements</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>14</span>
        <span/>
    </P>
    <P>
        <span>4.3</span>
        <span/>
        <span>vApp Name Requirements</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>17</span>
        <span/>
    </P>
    <P>
        <span>5</span>
        <span/>
        <span>Provisioning a vApp/VM for an Engineering Build</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>18</span>
        <span/>
    </P>
    <P>
        <span>6</span>
        <span/>
        <span>EMC OnDemand Environments</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>23</span>
        <span/>
    </P>
    <P>
        <span>6.1</span>
        <span/>
        <span>EMC OnDemand Key Servers and Services</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>23</span>
        <span/>
    </P>
    <P>
        <span>6.2</span>
        <span/>
        <span>EMC OnDemand vApp Engineering Lab</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>24</span>
        <span/>
    </P>
    <P>
        <span>6.3</span>
        <span/>
        <span>EMC OnDemand Production Data Centers</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>25</span>
        <span/>
    </P>
    <P>
        <span>7</span>
        <span/>
        <span>Authentication and Authorization Guide</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>26</span>
        <span/>
    </P>
    <P>
        <span>7.1</span>
        <span/>
        <span>OnDemand User Types</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>26</span>
        <span/>
    </P>
    <P>
        <span>7.2</span>
        <span/>
        <span>OnDemand Active Directory/LDAP Structure</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>27</span>
        <span/>
    </P>
    <P>
        <span>7.3</span>
        <span/>
        <span>Securing Your VMs</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>33</span>
        <span/>
    </P>
    <P>
        <span>7.3.1</span>
        <span/>
        <span>Installation and Execution Account Considerations</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>33</span>
        <span/>
    </P>
    <P>
        <span>7.3.2</span>
        <span/>
        <span>Operating System ACL Considerations</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>34</span>
        <span/>
    </P>
    <P>
        <span>8</span>
        <span/>
        <span>Customer Data and Data-At-Rest Encryption</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>39</span>
        <span/>
    </P>
    <P>
        <span>9</span>
        <span/>
        <span>Dynamic Provisioning Guide</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>40</span>
        <span/>
    </P>
    <P>
        <span>9.1</span>
        <span/>
        <span>Provisioning Overview</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>40</span>
        <span/>
    </P>
    <P>
        <span>9.2</span>
        <span/>
        <span>Provisioning Mechanism</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>42</span>
        <span/>
    </P>
    <P>
        <span>9.2.1</span>
        <span/>
        <span>VCUBE Portal Scripting</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>43</span>
        <span/>
    </P>
    <P>
        <span>9.2.2</span>
        <span/>
        <span>Guest Customization Scripts</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>45</span>
        <span/>
    </P>
    <P>
        <span>9.3</span>
        <span/>
        <span>How Guest Customization Works</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>50</span>
        <span/>
    </P>
    <P>
        <span>9.4</span>
        <span/>
        <span>Provisioning Customization</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>51</span>
        <span/>
    </P>
    <P>
        <span>10</span>
        <span/>
        <span>Putting it All Together</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>54</span>
        <span/>
    </P>
    <P>
        <span>11</span>
        <span/>
        <span>Software Provisioning and Support Manual Guide</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>59</span>
        <span/>
    </P>
    <P>
        <span>12</span>
        <span/>
        <span>vApp Construction Checklist</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>60</span>
        <span/>
    </P>
    <P>
        <span>13</span>
        <span/>
        <span>VM Upgrade Instructions</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>62</span>
        <span/>
    </P>
    <P>
        <span>13.1</span>
        <span/>
        <span>Upgrade Windows Server Operating System to Datacenter Edition</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>62</span>
        <span/>
    </P>
    <P>
        <span>Step 1: Take an existing guest OS from Standard Edition to DataCenter Edition</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>62</span>
        <span/>
    </P>
    <P>
        <span>Step 2: Validate that the guest OS is at the DataCenter edition</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>62</span>
        <span/>
    </P>
    <P>
        <span>13.2</span>
        <span/>
        <span>Removal of the Old Virus Scanner and VCM Package Manager</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>63</span>
        <span/>
    </P>
    <P>
        <span>13.3</span>
        <span/>
        <span>Add 7-zip, WinMerge, and Notepad++</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>64</span>
        <span/>
    </P>
    <P>
        <span>13.4</span>
        <span/>
        <span>Update VM Video RAM to 32 MB</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>64</span>
        <span/>
    </P>
    <P>
        <span>13.5</span>
        <span/>
        <span>Update to VMware Virtual Machine 8 and VMware Tools with vShield Driver</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>65</span>
        <span/>
    </P>
    <P>
        <span>13.6</span>
        <span/>
        <span>Use VMware Optimized LAN Adapter</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>67</span>
        <span/>
    </P>
    <P>
        <span>13.7</span>
        <span/>
        <span>Turn off IE ESC and UAC</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>68</span>
        <span/>
    </P>
    <P>
        <span>13.8</span>
        <span/>
        <span>Add a High Speed D: Drive for Optimized Sensitive Data Encryption</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>69</span>
        <span/>
    </P>
    <P>
        <span>14</span>
        <span/>
        <span>Change Control Log</span>
        <span/>
        <span/>
        <span/>
        <span/>
        <span/>
        <span>71</span>
        <span/>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>Overview</span>
    </P>
    <P/>
    <P>
        <span>EMC </span>
        <span>OnDemand is a new deployment model for EMC software products managed by EMC experts.  In order to manage the software, the software </span>
        <span>must</span>
        <span> be installed according to the guidelines in this document.  Otherwise the software will be too costly to administer and support and the customer will not achieve the benefits of this approach to running EMC software.</span>
    </P>
    <P>
        <span>In summary, customers are ex</span>
        <span>pecting the following benefits:</span>
    </P>
    <P>
        <span>Production-worthy</span>
        <span> platform ready in days instead of months (that is, everything required to develop a solution</span>
        <span> with the EMC products we provide, test the solution</span>
        <span>, and </span>
        <span>run the solution</span>
        <span> economically in production)</span>
    </P>
    <P>
        <span>Near zero installation on behalf of the customer (we pre-install all products offered for all the servers and thick client desktops we manage, desktop thin client installs are of course allowed and work as they do today)</span>
    </P>
    <P>
        <span>Best practice installs of all software products (we try to think of all the issues they could encounter, we do our best to install and configure the software so they don’t have such issues and can get to production much quicker than a default install of the software)</span>
    </P>
    <P>
        <span>The software is extensible </span>
        <span>vertically </span>
        <span>by adding VM resourc</span>
        <span>es and horizontally </span>
        <span>by </span>
        <span>adding new VMs wherever possible.</span>
    </P>
    <P>
        <span>In order to minimize operational costs to EMC to run this offering, the s</span>
        <span>oftware </span>
        <span>must be</span>
        <span> locked down from customer corruption wherever possible.</span>
        <span>  Customers must be prevented from altering or corrupting the software in a manner in which they would experience an application outage.  As a result of locking down this software, </span>
        <span>EMC </span>
        <span>OnDemand administrators</span>
        <span> will manage software configuration changes, patches, and upgrades on behalf of the customer so that the customer has the best EMC software experience possible.</span>
        <span>  Where it is not safe for a customer to deploy customizations or configuration changes (that is, we need to lock them down to prevent corruption or an application outage), EMC administrators will also manage such changes at the request of a customer.</span>
        <span>  EMC administrators must log any change before it is made and validate the change after it is made in a highly controlled </span>
        <span>and audited </span>
        <span>fashion.</span>
        <span>  Customer login to servers will be strictly prohibited, as will administrator access to desktops</span>
        <span>, as these practices could easily compromise the integrity of the software</span>
        <span>, would </span>
        <span>almost </span>
        <span>compromise </span>
        <span>the </span>
        <span>security</span>
        <span> of the offering</span>
        <span>,</span>
        <span> and will not provide a history of changes made for best practice environment management</span>
        <span>.</span>
    </P>
    <P>
        <span>Server log files and such must be made available to customers for self-service solution development and debugging</span>
        <span>.  These log files, like anything else in OnDemand,</span>
        <span/>
        <span>must</span>
        <span> secured for access only by privileged customer administrators.</span>
    </P>
    <P>
        <span>Applications must comply with the following requirements to be run inside of OnDemand:</span>
    </P>
    <P>
        <span>Infrastructure</span>
    </P>
    <P>
        <span>VM Naming</span>
    </P>
    <P>
        <span>Authentication and Authorization</span>
    </P>
    <P>
        <span>Dynamic Provisioning</span>
    </P>
    <P>
        <span>Software Provisioning and Support Manual</span>
    </P>
    <P>
        <span>VCUBE Terminology</span>
    </P>
    <P/>
    <P>
        <span>EMC OnDemand is built on top of a set of technologies we brand the “VCUBE” technology.  Before we proceed with the specifics of EMC OnDemand, let’s make sure we are on the same page with the terms used </span>
        <span>by the VCUBE technology itself.  </span>
        <span>Let’s start with the most fundamental concept, the VCUBE:</span>
    </P>
    <P/>
    <P>
        <span>VCUBE</span>
        <span> – A VCUBE is a container for software managed by the VCUBE Manager.  A VCUBE is currently powered by a VMware vCloud Director organization.  Each VCUBE has one and only one vCloud Director organization to run the VCUBE VMs/vApps.  A VCUBE has a vShield firewall, a network, and draws from a pool of compute and storage resources.  Today a VCUBE is dedicated to a single customer (tenant), but in the future we expect multiple customers could be hosted in a shared VCUBE (should the application running in the VCUBE be designed to safely host multiple tenants in the same instance of the software).</span>
    </P>
    <P/>
    <P>
        <span>VCUBE Manager</span>
        <span> – The VCUBE Manager is a set of hardware and software that makes it possible to create, manage, and delete VCUBEs.  The VCUBE Manager is a very large set of products -- more than 20 products from VMware, plus hardware and products like EMC DataDomain and Networker for backup, plus products like RSA NetWitness for security, plus 3</span>
        <span>rd</span>
        <span> party products like Trend Micro Deep Security and Splunk.  VCUBE software needs to be rigorously monitored, audited, backed up, scanned and protected from security issues, and so on, all of which is done by a host of hardware and software in a VCUBE Manager.  Each VCUBE Manager has a maximum 5 character identifier used in naming conventions so that software provisioned to be run by a VCUBE Manager can automatically connect to the correct hosts for that VCUBE Manager instance.</span>
    </P>
    <P/>
    <P>
        <span>The current design has a one-to-one relationship between a vCloud Director instance and a VCUBE Manager.  So a VCUBE Manager can have a maximum of one vCloud Director (and in the future, same goes for all the other primary concepts in the VCUBE Manager like monitoring, backup, security, and so on).</span>
    </P>
    <P/>
    <P>
        <span>Site</span>
        <span> – A Site is a set of compute and storage resources that makes it possible to run one or more VCUBEs.  A Site is </span>
        <span>not</span>
        <span> a VCUBE Manager.  A Site is </span>
        <span>run by</span>
        <span> a single VCUBE Manager.  A single VCUBE Manager can run multiple sites, should that site be small enough to be run by that VCUBE Manager.  For example, the “usva” VCUBE Manager could potentially run 1 fully loaded Vblock in the Virginia data center plus 3 other small on-premise VCUBE sites at 3 different customer locations.  Today we envision each site to have its own vCenter to manage the site (off-premise or on-premise) and keep it fault tolerant in the wake of a network outage back to the VCUBE Manager.  A particular vCloud Director instance can manage a maximum of 25 vCenter sites today.</span>
    </P>
    <P/>
    <P>
        <span>Tenant</span>
        <span> – A Tenant is an organizational unit (OU) in Active Directory to manage a set of identities (users), groups, service accounts, desktop pools, and so on, for accessing one or more VCUBEs.  If a set of identities requires access to more than one VCUBE, all the VCUBEs must use the same Tenant structure in Active Directory.  All Tenants managed by an instance of the VCUBE Manager portal are placed in the same Active Directory organization/domain which must be synced to any VCUBE Manager managed by the VCUBE Manager portal.  While there are more than one Active Directory/domain controller hosts per VCUBE Manager, and possibly many different VCUBE Managers, all of them must be synchronized or the portal will not function properly.</span>
    </P>
    <P/>
    <P>
        <span>User</span>
        <span> – A user in the VCUBE technology is an identity managed in the Active Directory system connected to the VCUBE Manager portal.  Today there are 3 types of Users in the VCUBE system:</span>
    </P>
    <P>
        <span>Tenant Administrator</span>
        <span> – This type of user is specific to a particular Tenant with the purpose of managing other users for that same Tenant.  The primary responsibility of a Tenant Administrator today is to perform identity management and role-based access control for all of the other users required for that Tenant.</span>
    </P>
    <P/>
    <P>
        <span>Tenant User</span>
        <span> – This type of user is specific to a particular Tenant with the purpose of using one or more applications available to that Tenant.  These users get a LaunchPad of all the different managed desktops and managed server URLs that they have access to as granted by their Tenant Administrator(s).  Note that Tenant Administrators are also Tenant Users once they are granted one or more Roles as defined below.</span>
    </P>
    <P/>
    <P>
        <span>VCUBE Administrator</span>
        <span> – This type of user is a global VCUBE system administrator.  They have access to all VCUBEs managed by all VCUBE Managers in the VCUBE Manager portal, for the purpose of provisioning VCUBEs and applications inside each of the customer VCUBEs.  VCUBE Administrators do not have the ability to access the applications inside the VCUBEs.  For security reasons, only Tenant Users have access to the Roles granting application permissions.</span>
    </P>
    <P/>
    <P/>
    <P>
        <span>Environment</span>
        <span> – An Environment is a logical name for a set of software that works together to accomplish some useful purpose.  That purpose could be running a production system.  Or it could be running some type of test system (development, system test, integration test, model office, or sandbox, and so on).  Each customer/tenant defines the set of environments they want to run in their VCUBEs.  They get control over naming them.  Some customers have one production environment, some have many.  There is no way to predict how many environments a customer will want to run or what they will name them.  So each Tenant in the VCUBE architecture must specify their list of environments.  Server software cannot be provisioned to a VCUBE for a Tenant until that Tenant has designated what Environments they want to run.  Once the Tenant has done so, then we provision each server specifically to an Environment that has already been set up for the Tenant.</span>
    </P>
    <P/>
    <P>
        <span>Note that an Environment is </span>
        <span>not</span>
        <span> a running piece of software!  An Environment is basically a naming construct only.  In the VCUBE architecture, an Environment has a 2 character identifier (exactly 2 and only 2 characters).  You cannot provision a server set of software until you have identified the Environment designated for that server.  Each VM in the server set of software then takes on that environment name and that environment name pervades that instance of the server software so that anything with that environment/tenant name can automatically talk to anything else with that environment/tenant name.  For example, xPression has integration capabilities to Documentum.  If xPression and Documentum get provisioned in the same VCUBE for the same environment and tenant, then xPression must automatically and correctly integrate with Documentum in that same VCUBE for that same tenant and environment (that is, xPression “d1” environment must automatically talk to Documentum “d1” environment if in the same VCUBE for the same Tenant).</span>
    </P>
    <P/>
    <P>
        <span>Application</span>
        <span> – An application is a software system that is capable of being managed by the VCUBE technology.  The application conforms to all the VCUBE standards so that when the VMs come alive inside a VCUBE, the VCUBE Manager knows how to manage them going forward.  An Application is </span>
        <span>much more</span>
        <span> than just running VMs.  It is an end-to-end software system that allows the VCUBE technology to automatically provision, patch, (and hopefully someday) upgrade the system.  It contains managed servers and managed desktops (should the system require a managed desktop to provide its full feature set).  It contains definitions of roles that are mapped to the software so that the VCUBE Manager portal can provide self-service identity management and role-based access control features for each Tenant.  Applications need to understand the concept of a VCUBE environment and act accordingly.</span>
    </P>
    <P/>
    <P>
        <span>Role</span>
        <span> – A Role is a name for one or more application permissions or features that a Tenant User is allowed to perform when assigned that role.  A role can be very specific, like the ability to log into xPression xDashboard.  Or it could be very generic, like the Documentum Administrator role which allows a user to get access to a Documentum Administrator desktop, view server log files, work with Composer, and so on.  Security best practices dictate that no one can do anything without being first assigned permission to do so.  In a VCUBE, that permission is a Role.  If a Tenant user has no roles, then even though they have a userid in the VCUBE system, they will have no access to perform any application function in the entire system.  Roles are the fundamental construct for role-based access control in the VCUBE technology.  Roles are implemented as Active Directory </span>
        <span>groups, which must then be integrated with the running applications in a VCUBE so the applications permit or deny access to application features according to group assignment to Tenant Users.</span>
    </P>
    <P/>
    <P>
        <span>Module</span>
        <span/>
        <span>- A Module is an umbrella term for basically an independently provisionable and manageable portion of an application.  Large applications could be composed of many different modules, all working together to form a software system.  For example, Documentum has a managed administrator desktop module, a content server core module, a CTS module, a D2 module, an EPFM module, and so on.  When provisioned, a Module is typically a vApp running in a vCloud Director organization (that is, inside a particular Tenant’s VCUBE).</span>
    </P>
    <P/>
    <P>
        <span>Note that we use the term “module” instead of the term “vApp” because an xMS aware application may be provisioned from a blueprint instead of a vApp.</span>
    </P>
    <P/>
    <P>
        <span>Module Family</span>
        <span> –  A Module Family is a grouping concept for modules that all serve the same purpose and function, but have different versions.  The system could have a Documentum 6.7 Administrator Desktop and a Documentum 7.0 Administrator Desktop.  These are 2 different modules, but they both belong to the same Module Family.  If they do not, the VCUBE Manager could provision both in the same namespace and corrupt the VCUBE.  So if everything is identical in form and feature for 2 modules but they are just different versions of the application or the vApp template, they </span>
        <span>must</span>
        <span> belong to the same Module Family to protect the future integrity of the VCUBE.</span>
    </P>
    <P/>
    <P>
        <span>Module Template</span>
        <span> – A Module Template is an umbrella term for either a vApp Template in vCloud Director or a Blueprint (when using xMS deployed applications).  A Module Template contains enough information for the VCUBE technology to provision a fully functional module for a Tenant inside a VCUBE.  If that Module Template is a vApp type Module Template, then the Module Template must have information in it to determine how many and what type of VMs are in the vApp Template, where roles are implemented in the vApp, how those roles map to quotas, how the VMs map to firewall rules, what scripts are run for guest customization and post-customization, what sites house the vApp for provisioning deployment, and anything else that would be helpful to provision and manage a module created from this module template.</span>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>Infrastructure</span>
        <span> Guide</span>
    </P>
    <P>
        <span>For the initial release of EMC OnDemand, the execution platform will be restricted to what we can manage</span>
        <span>.</span>
        <span/>
        <span>A</span>
        <span>s we ramp up the infrastructure and the team to manage the</span>
        <span> infrastructure, we will allow other options and more flexibility</span>
        <span>.</span>
    </P>
    <P>
        <span>Hardware and Virtual Infrastructure Environment</span>
    </P>
    <P/>
    <P>
        <span>EMC OnDemand currently supports the </span>
        <span>following hardware and virtual infrastructure stack:</span>
    </P>
    <P>
        <span>Intel (Nehalem class or better) CPUs only, AMD CPUs are not supported</span>
    </P>
    <P>
        <span>VMware vSphere 5.0 and vCenter 5.0</span>
    </P>
    <P>
        <span>VMware vCloud Director 1.5 and vShield 5.0</span>
    </P>
    <P>
        <span>VMware View 4.6 for managed desktops</span>
    </P>
    <P>
        <span>All VMs running OnDemand products must be provided as managed server or managed desktop VMs inside a vCloud Director compliant and cataloged vApp (one vApp for all the managed servers required to run the product, a separate vApp for each type of managed desktop required to run the product).</span>
    </P>
    <P>
        <span>Managed Server</span>
        <span> VMs</span>
    </P>
    <P>
        <span>EMC OnDemand will provide base server VM builds for product teams to install into.  The build will be as follows:</span>
    </P>
    <P>
        <span>Microsoft Windows Server 2008 R2</span>
        <span> SP1</span>
        <span> Datacenter</span>
        <span> Edition 64-bit</span>
    </P>
    <P>
        <span>This is a recent upgrade from Standard Edition for reasons explained in the upgrades section of this document below.</span>
    </P>
    <P>
        <span>At this time no other server operating systems will be supported.</span>
        <span>  OnDemand will take responsibility for properly licensing this operating system.</span>
        <span>  Teams cannot build their own operating system</span>
        <span> VM</span>
        <span>, they must start from the EMC OnDemand </span>
        <span>VM </span>
        <span>template which will contain our operating system</span>
        <span> licenses,</span>
        <span> management software products</span>
        <span>,</span>
        <span> and </span>
        <span>administration </span>
        <span>policies.</span>
    </P>
    <P/>
    <P>
        <span>Application Startup and Shutdown Standards</span>
    </P>
    <P>
        <span>All products running on the servers must be automatically started and managed via Windows Services.</span>
        <span>  Scripted shutdown and startup is not allowed as it will be too costly to administer.  Should there be dependencies between services, this must be configured via the standard Windows Service dependency mechanism so that a server will be fully operational simply by booting the operating system.</span>
    </P>
    <P/>
    <P>
        <span>Java Application Server Standards</span>
    </P>
    <P>
        <span>Should the products require a Java applic</span>
        <span>ation server, a</span>
        <span> no cost license version of JBoss or Tomcat is </span>
        <span>recommended</span>
        <span>.</span>
        <span>  Other products will be permitted on a case by case basis and only as long as the application owner takes licensing responsibility.</span>
    </P>
    <P/>
    <P>
        <span>Web Server Standards</span>
    </P>
    <P>
        <span>For any product requiring HTTP and HTTPS interfaces, the only supported web server at this time is Microsoft IIS.  We strongly recommend using IIS as the port 80</span>
        <span> and 443</span>
        <span> interface over using JBoss </span>
        <span>or Tomcat to directly serve</span>
        <span> the</span>
        <span> default HTTP </span>
        <span>and HTTPS </span>
        <span>port</span>
        <span>s</span>
        <span>.  We will not support JBoss or Tomcat HTTPS as </span>
        <span>it is not efficient, is not best practice, cannot be easily clustered, and </span>
        <span>HTTPS requires a strong certificate and we will only support strong certificates via IIS at this time.</span>
        <span>  JBoss and Tomcat HTTPS must be disabled.</span>
    </P>
    <P/>
    <P>
        <span>FTP</span>
        <span>/FTPS</span>
        <span> Server Standards</span>
    </P>
    <P>
        <span>Should a product require bulk file transfer</span>
        <span>, OnDemand will support 2 mechanisms.  To begin with, we will </span>
        <span>support Microsoft FTP Server with</span>
        <span> FTP and FTPES protocols</span>
        <span> only</span>
        <span>.  In the near future we will also support </span>
        <span>a</span>
        <span> 3</span>
        <span>rd</span>
        <span> party product which wi</span>
        <span>ll more efficiently relay files between the customer’s network</span>
        <span> and the VCUBE network</span>
        <span>.</span>
    </P>
    <P>
        <span>Shared server files are only permitted in a dir</span>
        <span>ectory named D</span>
        <span>:\Shared\&lt;product name&gt;.  This directory can be enabled for Windows file sharing</span>
        <span> at a minimum and also enabled for FTP and FTPES as appropriate for a best practice customer experience</span>
        <span>.</span>
    </P>
    <P/>
    <P>
        <span>Server</span>
        <span> File Sharing</span>
        <span> Standards</span>
    </P>
    <P>
        <span>Most server software requires </span>
        <span>customers (developers, administrators)</span>
        <span> access to files on the s</span>
        <span>erver.  The only files a customer will be permitted to access are files in the </span>
        <span>D:\Shared\&lt;product name&gt; </span>
        <span>directory on the server.  When installing your product, you must redirect any pertinent file locations to that directory which are appropriate for access by your customers.  This file directory cannot contain installed </span>
        <span>executable files</span>
        <span> or configuration settings which could cause the software to stop running or jeopardize the quality of the software.  Such files must </span>
        <span>instead </span>
        <span>be relayed to the OnDemand administration team and put in place with change requests for best practice environment management practices.</span>
    </P>
    <P>
        <span>Examples of files which are appropriate for this area of the server are log files and other important debugging files, resources that need to be accessible by the server (input XML files, output documents, fonts), templates and workflow definitions which need to be imported into the server, and development files which need to be shared across development desktops.</span>
    </P>
    <P/>
    <P>
        <span>Database Standards</span>
    </P>
    <P>
        <span>Should the products require a database server, the products </span>
        <span>should</span>
        <span> utilize</span>
        <span> the following relational database:</span>
    </P>
    <P>
        <span>Microsoft </span>
        <span>SQL Server 2008 R2 64-bit running </span>
        <span>on the </span>
        <span>server </span>
        <span>operating system above</span>
    </P>
    <P>
        <span>OnDemand will take responsibility for licensing this product.</span>
    </P>
    <P>
        <span>OnDemand is not prepared to work with any other databases at this time as we must provide a best practice backup/restore capability for databases (and perhaps data encryption</span>
        <span> capabilities</span>
        <span> as well).</span>
        <span>  Should products require other databases or proprietary databases, the products should be prepared for simple file backup and restore operations only and must take responsibility for licensing </span>
        <span>and data encryption of sensitive information</span>
        <span> on their own.</span>
    </P>
    <P>
        <span>Managed Desktops</span>
    </P>
    <P/>
    <P>
        <span>EMC OnDemand will provide base desktop VM builds for product teams to install into.  The build will be as follows:</span>
    </P>
    <P>
        <span>Microsoft </span>
        <span>Windows </span>
        <span>RDS Server 2008 R2 SP1 64-bit</span>
    </P>
    <P>
        <span>VMware View 4.6</span>
    </P>
    <P>
        <span>All products run on managed desktops must use this operating system and must run acceptably over a wide area network connection via VMware View.</span>
        <span>  Note that we cannot install the VMware View Agent on a template and then provision that template.  VMware View Agent apparently requires the host name and other information to be static after you install the agent.  So if we install the agent in a template and clone it, the agent will not work properly and will cause all kinds of problems in the environment.  Installing the View Agent must be done after provisioning but before adding to a View pool.</span>
    </P>
    <P>
        <span>Note that this terminology is a bit confusing.  We are running “managed desktops” on a server operating system.  Microsoft will not permit us to run Windows 7 desktops</span>
        <span> (or any other Windows desktop operating system)</span>
        <span> in OnDemand, they will not license the software</span>
        <span> for such a use</span>
        <span>.  So we have no choice but to switch to RDS Server for our managed desktops.  From here on out, even though managed desktops are run on a server operating system, we will still call them “managed desktops.”</span>
    </P>
    <P>
        <span>OnDemand will take responsibility for licensing the operating system, VMware View, and the other operating system management products (for example virus scan) but not any other 3</span>
        <span>rd</span>
        <span> party products installed onto the operating system by the product teams.</span>
    </P>
    <P>
        <span>Product teams may install products into the desktop VM as an administrator account.  However, the products must not require administrator rights to be executed by end users.  </span>
        <span>Customer end users will log into the desktops as normal users without administrator rights.  Products</span>
        <span> must also be installed for any user on the desktop, not a particular user (as that user will of course not be known in advance).</span>
    </P>
    <P>
        <span>Note that the operating system above allows many users to log into the same operating system.  Unless you make special arrangements with the OnDemand team to dedicate a server to a particular user, you must expect many users on that operating system to be running at the same time.  Your software must work properly in that </span>
        <span>fashion otherwise OnDemand will incur large infrastructure and administration costs to dedicate a whole server to just one user.</span>
        <span/>
    </P>
    <P>
        <span>VM Naming Guide</span>
    </P>
    <P>
        <span>All VMs in all VCUBEs in the entire world-wide OnDemand environment must be uniquely named.  VM host names have a restriction of a maximum of 15 characters, so therefore OnDemand has strict guidelines for naming all </span>
        <span>managed </span>
        <span>server and desktop </span>
        <span>VMs.</span>
        <span>  These naming conventions must be carried out even in lab/development environments or you could conflict on the network and harm other vApp development efforts.</span>
    </P>
    <P>
        <span>Server Name Requirements</span>
    </P>
    <P>
        <span>All managed servers must conform to the following naming convention:</span>
    </P>
    <P/>
    <P>
        <span>&lt;p</span>
        <span>roduct&gt;</span>
        <span>&lt;s</span>
        <span>erverType&gt;</span>
        <span>&lt;e</span>
        <span>nvironment&gt;</span>
        <span>&lt;instance#&gt;</span>
        <span>-&lt;</span>
        <span>tenant</span>
        <span>&gt;</span>
    </P>
    <P/>
    <P>
        <span>p</span>
        <span>roduct (3 chars)</span>
    </P>
    <P>
        <span/>
        <span>xpr</span>
        <span/>
        <span>–</span>
        <span> xPression</span>
    </P>
    <P>
        <span/>
        <span>cap</span>
        <span/>
        <span>–</span>
        <span> Captiva</span>
    </P>
    <P>
        <span/>
        <span>dtm</span>
        <span/>
        <span>–</span>
        <span> Documentum</span>
        <span> (base Documentum Content Server)</span>
    </P>
    <P>
        <span/>
        <span>xpl</span>
        <span/>
        <span>–</span>
        <span> xPlore</span>
    </P>
    <P>
        <span/>
        <span>csg</span>
        <span/>
        <span>–</span>
        <span> CenterStage</span>
    </P>
    <P>
        <span/>
        <span>cts</span>
        <span/>
        <span>–</span>
        <span> Content Transformation Services</span>
    </P>
    <P>
        <span/>
        <span>xcp</span>
        <span/>
        <span>–</span>
        <span> Documentum xCP</span>
    </P>
    <P>
        <span>  epf </span>
        <span>–</span>
        <span> EPFM</span>
    </P>
    <P>
        <span>  dd2 </span>
        <span>–</span>
        <span> D2</span>
    </P>
    <P/>
    <P>
        <span>M</span>
        <span>ore products can be registered wit</span>
        <span>h the OnDemand team as required.</span>
    </P>
    <P>
        <span> </span>
    </P>
    <P>
        <span>s</span>
        <span>erver Type (1 char</span>
        <span> alphabetic</span>
        <span>)</span>
    </P>
    <P>
        <span/>
        <span>a</span>
        <span/>
        <span>–</span>
        <span> Application server</span>
    </P>
    <P>
        <span/>
        <span>d</span>
        <span/>
        <span>–</span>
        <span> Database server</span>
    </P>
    <P>
        <span>  l </span>
        <span>–</span>
        <span> Load balancer (note this is a reserved letter, please do not use the letter </span>
        <span>“</span>
        <span>L</span>
        <span>”</span>
        <span> in your VMs as it would prevent you from using the OnDemand standard load balancing vApp)</span>
    </P>
    <P>
        <span/>
        <span>u</span>
        <span/>
        <span>–</span>
        <span> Utility server</span>
    </P>
    <P>
        <span/>
        <span>u</span>
        <span/>
        <span>–</span>
        <span> Captiva unattended client utility server</span>
    </P>
    <P>
        <span/>
        <span>c</span>
        <span/>
        <span>–</span>
        <span> Documentum content server</span>
    </P>
    <P>
        <span/>
        <span>c</span>
        <span/>
        <span>–</span>
        <span> Captiva console server</span>
    </P>
    <P>
        <span/>
        <span> i</span>
        <span>  - Index server</span>
    </P>
    <P>
        <span>  t</span>
        <span/>
        <span>–</span>
        <span> CTS Transformation Server</span>
    </P>
    <P/>
    <P>
        <span>Server type is a single alphabetic character for each type of VM you provide inside a product.  Server types cannot conflict with a desktop type (see below), and you of course cannot provide 2 or more VMs in the same product that have the same server type (unless they are horizontal cluster nodes for scalability purposes).  </span>
        <span>M</span>
        <span>ore server types can be registered with the OnDemand team</span>
        <span> and they can have specific naming or meaning within your Product prefix within reason</span>
        <span>.</span>
    </P>
    <P/>
    <P>
        <span>e</span>
        <span>nvironment (2 chars)</span>
    </P>
    <P>
        <span/>
        <span>d</span>
        <span>1 </span>
        <span>–</span>
        <span> Development #1</span>
    </P>
    <P>
        <span/>
        <span>s</span>
        <span>1 </span>
        <span>–</span>
        <span> Sandbox #1</span>
    </P>
    <P>
        <span/>
        <span>t</span>
        <span>1 </span>
        <span>–</span>
        <span> Test #1</span>
    </P>
    <P>
        <span/>
        <span>p</span>
        <span>1 </span>
        <span>–</span>
        <span> Production #1</span>
    </P>
    <P>
        <span>(the environment ID is at the discretion of the </span>
        <span>tenant</span>
        <span> as long as it always 2 characters in length, </span>
        <span>d</span>
        <span>1 is the default development environment)</span>
    </P>
    <P/>
    <P>
        <span>i</span>
        <span>nstance # (1 char)</span>
    </P>
    <P>
        <span>Required for all servers except load balancers</span>
    </P>
    <P>
        <span>      (start at 1 and increase, use letters </span>
        <span>a</span>
        <span>, </span>
        <span>b</span>
        <span>, </span>
        <span>…</span>
        <span> if necessary</span>
        <span> to go beyond 9</span>
        <span>)</span>
    </P>
    <P/>
    <P>
        <span>tenant</span>
        <span> (2</span>
        <span>-6 characters</span>
        <span> alphanumeric</span>
        <span>)</span>
    </P>
    <P>
        <span>Abbreviated name of the </span>
        <span>tenant</span>
        <span>, alphabetic and numeric characters only, no spaces</span>
        <span>, lowercase</span>
        <span>.</span>
    </P>
    <P/>
    <P>
        <span>Examples:</span>
    </P>
    <P>
        <span> </span>
    </P>
    <P>
        <span>xpr</span>
        <span>d</span>
        <span>d</span>
        <span>1</span>
        <span>1</span>
        <span>-xpreng</span>
    </P>
    <P>
        <span>xPression database server DEV1 environment 1</span>
        <span>st</span>
        <span> instance inside the xpreng vApp engineering org in the lab</span>
    </P>
    <P/>
    <P>
        <span>xpr</span>
        <span>a</span>
        <span>d</span>
        <span>1</span>
        <span>1</span>
        <span>-</span>
        <span>uhg</span>
    </P>
    <P>
        <span>xPression application server DEV1 environment 1</span>
        <span>st</span>
        <span> instance for </span>
        <span>tenant</span>
        <span/>
        <span>“</span>
        <span>uhg</span>
        <span>”</span>
    </P>
    <P/>
    <P>
        <span>cap</span>
        <span>u</span>
        <span>t</span>
        <span>1</span>
        <span>2</span>
        <span>-</span>
        <span>boa</span>
    </P>
    <P>
        <span>Captiva unattended client server</span>
    </P>
    <P>
        <span>TEST1 environment 2</span>
        <span>nd</span>
        <span> instance for </span>
        <span>tenant</span>
        <span/>
        <span>“</span>
        <span>boa</span>
        <span>”</span>
    </P>
    <P/>
    <P>
        <span>dtm</span>
        <span>c</span>
        <span>p</span>
        <span>2</span>
        <span>4</span>
        <span>-</span>
        <span>erics</span>
    </P>
    <P>
        <span>Documentum content server PROD2 environment 4</span>
        <span>th</span>
        <span> instance for </span>
        <span>tenant</span>
        <span/>
        <span>“</span>
        <span>erics</span>
        <span>”</span>
    </P>
    <P>
        <span> </span>
    </P>
    <P>
        <span>Desktop Name Requirements</span>
    </P>
    <P>
        <span>Before a </span>
        <span>managed </span>
        <span>desktop VM is provisioned, when it is in a template used for testing and saved to a catalog, it must conform to the following naming convention:</span>
    </P>
    <P/>
    <P>
        <span>&lt;p</span>
        <span>roduct&gt;</span>
        <span>&lt;desktopType&gt;</span>
        <span>&lt;</span>
        <span>build</span>
        <span>ID&gt;</span>
        <span>-&lt;</span>
        <span>tenant</span>
        <span>&gt;</span>
    </P>
    <P/>
    <P/>
    <P>
        <span>product (3 </span>
        <span>alphanumeric </span>
        <span>chars)</span>
    </P>
    <P>
        <span>  xpr </span>
        <span>–</span>
        <span> xPression</span>
    </P>
    <P>
        <span>  cap </span>
        <span>–</span>
        <span> Captiva</span>
    </P>
    <P>
        <span>  dtm </span>
        <span>–</span>
        <span> Documentum (base Documentum Content Server)</span>
    </P>
    <P>
        <span>  xpl </span>
        <span>–</span>
        <span> xPlore</span>
    </P>
    <P>
        <span>  csg </span>
        <span>–</span>
        <span> CenterStage</span>
    </P>
    <P>
        <span>  cts </span>
        <span>–</span>
        <span> Content Transformation Services</span>
    </P>
    <P>
        <span>  xcp </span>
        <span>–</span>
        <span> Documentum xCP</span>
    </P>
    <P>
        <span>  epf - EPFM</span>
    </P>
    <P/>
    <P>
        <span>More products can be registered with the OnDemand team as required.</span>
    </P>
    <P/>
    <P>
        <span>&lt;desktopType&gt;</span>
        <span> (1 alphabetic char)</span>
    </P>
    <P>
        <span>r </span>
        <span>–</span>
        <span> remote desktop</span>
    </P>
    <P>
        <span>s </span>
        <span>–</span>
        <span> developer (</span>
        <span>“</span>
        <span>superuser</span>
        <span>”</span>
        <span>) desktop</span>
    </P>
    <P/>
    <P>
        <span>Desktop</span>
        <span> type is a unique alphabetic letter within the product (that is, it cannot conflict with any server type used above for that product) and identifies the type of desktop that is pooled. </span>
        <span>Note that </span>
        <span>“</span>
        <span>L</span>
        <span>”</span>
        <span> for load balancer is a reserved letter for a server type and cannot be used for a desktop type.</span>
    </P>
    <P/>
    <P>
        <span>b</span>
        <span>uild</span>
        <span> ID (2 </span>
        <span>alphabetic </span>
        <span>chars)</span>
    </P>
    <P>
        <span/>
        <span>a</span>
        <span>a </span>
        <span>–</span>
        <span>build </span>
        <span>“</span>
        <span>aa</span>
        <span>”</span>
    </P>
    <P>
        <span>  ic </span>
        <span>–</span>
        <span>build </span>
        <span>“</span>
        <span>ic</span>
        <span>”</span>
    </P>
    <P/>
    <P>
        <span>No restriction on the </span>
        <span>build</span>
        <span/>
        <span>identifier except that it must always be 2 </span>
        <span>alphabetic </span>
        <span>characters, each product must manage its own unique </span>
        <span>build</span>
        <span> IDs as it develops </span>
        <span>new versions of a vApp so they don</span>
        <span>’</span>
        <span>t conflict in the xxxeng org as you work on potentially different versions of the vApp in the org.</span>
    </P>
    <P/>
    <P>
        <span>tenant</span>
        <span> (2-6 characters alphanumeric)</span>
    </P>
    <P>
        <span>Abbreviated name of the </span>
        <span>tenant</span>
        <span>, alphabetic and numeric characters only, no spaces</span>
    </P>
    <P/>
    <P>
        <span>Note that there are a few very important differences between a server VM name and a desktop VM name.  First of all, there is no environment for a desktop.  Environments are a server</span>
        <span> only concept</span>
        <span>.  Desktops cross environments (</span>
        <span>for example, </span>
        <span>most products can typically connect a thick client desktop to dev, test, or production).  So environment ID makes no sense for a desktop and is not in the naming convention.  Second, we have a desktop type instead of a server type, but it is essentially the same</span>
        <span> concept</span>
        <span>.  Both desktop and server types must be unique within a product (can’t have a “d” server type and a “d” desktop type for the same product, that would confuse OnDemand operations).  Next</span>
        <span> we have a build identifier so that you can provision multiple of the same desktops in your xxxeng org for development purposes (you can do the same thing for server vApps by modifying the environment ID).  And finally in the xxxeng org and the </span>
        <span>vApp </span>
        <span>template you won’t have an instance number.  There is no pool in the template vApp so no reason for an instance number, </span>
        <span>an instance number in the template</span>
        <span> would just confuse the provisioning system.  </span>
        <span>We will add the instance number at provisioning time.  Also note that only 1 VM is allowed in a Desktop vApp template.  All desktops are run as VMware View pools, and each desktop in the pool is a clone of the one and only one VM in the vApp template.  So having more than one VM in the vApp would </span>
        <span>also</span>
        <span> confuse the provisioning system as it would not know what VM to clone and pool.</span>
    </P>
    <P/>
    <P>
        <span>Once a desktop VM is provisioned for a </span>
        <span>tenant</span>
        <span>, it must conform to the following naming convention:</span>
    </P>
    <P/>
    <P>
        <span>&lt;p</span>
        <span>roduct&gt;</span>
        <span>&lt;desktopType&gt;</span>
        <span>&lt;</span>
        <span>viewPool</span>
        <span>ID&gt;</span>
        <span>&lt;instance#&gt;</span>
        <span>-&lt;</span>
        <span>tenant</span>
        <span>&gt;</span>
    </P>
    <P/>
    <P>
        <span>product (3 chars)</span>
    </P>
    <P>
        <span>  xpr </span>
        <span>–</span>
        <span> xPression</span>
    </P>
    <P>
        <span>  cap </span>
        <span>–</span>
        <span> Captiva</span>
    </P>
    <P>
        <span>  dtm </span>
        <span>–</span>
        <span> Documentum (base Documentum Content Server)</span>
    </P>
    <P>
        <span>  xpl </span>
        <span>–</span>
        <span> xPlore</span>
    </P>
    <P>
        <span>  csg </span>
        <span>–</span>
        <span> CenterStage</span>
    </P>
    <P>
        <span>  cts </span>
        <span>–</span>
        <span> Content Transformation Services</span>
    </P>
    <P>
        <span>  xcp </span>
        <span>–</span>
        <span> Documentum xCP</span>
    </P>
    <P>
        <span>  epf - EPFM</span>
    </P>
    <P/>
    <P>
        <span>M</span>
        <span>ore products can be registered wit</span>
        <span>h the OnDemand team as required.</span>
    </P>
    <P/>
    <P>
        <span>&lt;desktopType&gt;</span>
    </P>
    <P>
        <span>r </span>
        <span>–</span>
        <span> remote desktop</span>
    </P>
    <P>
        <span>s </span>
        <span>–</span>
        <span> developer (</span>
        <span>“</span>
        <span>superuser</span>
        <span>”</span>
        <span>) desktop</span>
    </P>
    <P/>
    <P>
        <span>Desktop</span>
        <span> type is a unique letter within the product (that is, it cannot conflict with any server type used above for that product) and identifies the type of desktop that is pooled. </span>
    </P>
    <P/>
    <P>
        <span>view Pool</span>
        <span> ID (2</span>
        <span/>
        <span>alphabetic </span>
        <span>chars)</span>
    </P>
    <P>
        <span/>
        <span>z</span>
        <span>a</span>
        <span>-zz</span>
    </P>
    <P/>
    <P>
        <span>The provisioning system for a specific product prefix and </span>
        <span>tenant</span>
        <span> suffix will start with za and run through zz as uniq</span>
        <span>ue View Pool identifiers for the tenant </span>
        <span>(for a maximum of 26 desktop pools for a particular product/</span>
        <span>tenant</span>
        <span>, which is hopefully an ample number).</span>
    </P>
    <P/>
    <P>
        <span>i</span>
        <span>nstance # (2</span>
        <span> numeric digits starting</span>
        <span> with </span>
        <span>01)</span>
    </P>
    <P>
        <span>Allows for up to </span>
        <span>99 desktops in a single View pool</span>
        <span>, with each desktop running many users, this will scale well beyond what our </span>
        <span>tenant</span>
        <span>s will require of managed desktops.</span>
    </P>
    <P/>
    <P>
        <span>tenant</span>
        <span> (2</span>
        <span>-6 characters</span>
        <span> alphanumeric</span>
        <span>)</span>
    </P>
    <P>
        <span>Abbreviated name of the </span>
        <span>tenant</span>
        <span>, alphabetic and numeric characters only, no spaces</span>
    </P>
    <P/>
    <P/>
    <P>
        <span>Pre-Provisioning </span>
        <span>Examples:</span>
    </P>
    <P>
        <span> </span>
    </P>
    <P>
        <span>xpr</span>
        <span>r</span>
        <span>da</span>
        <span>-xpreng</span>
    </P>
    <P>
        <span>xPression Developer Desktop build </span>
        <span>“</span>
        <span>da</span>
        <span>”</span>
        <span> for a vApp that was developed and checked into the xpreng </span>
        <span>tenant</span>
        <span> organization</span>
    </P>
    <P/>
    <P>
        <span>cap</span>
        <span>m</span>
        <span>ac</span>
        <span>-capeng</span>
    </P>
    <P>
        <span>Captiva End User Desktop build </span>
        <span>“</span>
        <span>ac</span>
        <span>”</span>
        <span> desktop for a vApp that was developed and checked into the capeng </span>
        <span>tenant</span>
        <span> organization</span>
    </P>
    <P/>
    <P>
        <span>Post-Provisioning </span>
        <span>Examples:</span>
    </P>
    <P>
        <span> </span>
    </P>
    <P>
        <span>xpr</span>
        <span>r</span>
        <span>z</span>
        <span>a</span>
        <span>03</span>
        <span>-</span>
        <span>uhg</span>
    </P>
    <P>
        <span>xPression Developer Desktop </span>
        <span>instance</span>
        <span> 3 in the </span>
        <span>“</span>
        <span>za</span>
        <span>”</span>
        <span> View </span>
        <span>pool for </span>
        <span>tenant</span>
        <span/>
        <span>“</span>
        <span>uhg</span>
        <span>”</span>
    </P>
    <P/>
    <P>
        <span>cap</span>
        <span>m</span>
        <span>zd</span>
        <span>8</span>
        <span>4</span>
        <span>-</span>
        <span>boa</span>
    </P>
    <P>
        <span>Captiva </span>
        <span>End User Desktop instance</span>
        <span> 8</span>
        <span>4 in the </span>
        <span>“</span>
        <span>zd</span>
        <span>”</span>
        <span> View </span>
        <span>pool for </span>
        <span>tenant</span>
        <span/>
        <span>“</span>
        <span>b</span>
        <span>oa</span>
        <span>”</span>
    </P>
    <P/>
    <P>
        <span>vApp Name Requirements</span>
    </P>
    <P/>
    <P>
        <span>EMC OnDemand needs to know every detail about a vApp in order to properly provision and support it for customers.</span>
        <span>  Therefore, the vApp name is a critical piece of information.  That name must be mapped to a vApp provisioning and support</span>
        <span/>
        <span>manual which documents exactly what software is installed in that vApp and most important of all, </span>
        <span>how</span>
        <span> it is installed.  There are thousands of ways the exact same piece of software can be installed.  You can pick different directory locations, different places for log files to be written, different ACLs on those log files, all for the exact same version of the software.  So therefore you need to tell OnDemand exactly what is in your vApp.  We do that through a naming convention for the vApp and a corresponding vApp provisioning and support manual (described in subsequent sections).</span>
    </P>
    <P/>
    <P>
        <span>vApps always have the following very important pieces of information in the following order:</span>
    </P>
    <P/>
    <P>
        <span>&lt;Software Component Name&gt;</span>
        <span> &lt;Software Version&gt; </span>
        <span>&lt;Server or Desktop&gt;</span>
        <span> &lt;vApp Build Version&gt;</span>
        <span> (prep)</span>
    </P>
    <P/>
    <P>
        <span>Examples:</span>
    </P>
    <P/>
    <P>
        <span>Documentum Core</span>
        <span> 6.7 SP1 </span>
        <span>Server</span>
        <span> v. 1.3</span>
    </P>
    <P>
        <span>xPression</span>
        <span> 4.2 </span>
        <span>Server</span>
        <span> v. 3.2</span>
    </P>
    <P>
        <span>Captiva User</span>
        <span> 6.5 SP1 </span>
        <span>Desktop</span>
        <span> v. 0.9</span>
    </P>
    <P>
        <span>Captiva Developer</span>
        <span> 6.5 SP1 </span>
        <span>Desktop</span>
        <span> v. 0.2</span>
    </P>
    <P>
        <span>CTS</span>
        <span> 6.7 SP1 </span>
        <span>Server</span>
        <span> v. 1.9</span>
    </P>
    <P/>
    <P>
        <span>Notes on the above examples.  Captiva has 2 different types of desktops.  So it is not sufficient to just state Captiva … Desktop, it must be a “Captiva User” desktop or a “Captiva Developer” desktop.</span>
        <span>  If a product has multiple server vApps, then the Software Component Name must uniquely identity the type of server.</span>
    </P>
    <P/>
    <P>
        <span>The Software Version is the exact version of the software as released by product engineering.</span>
    </P>
    <P/>
    <P>
        <span>The vApp Build version is basically a source control identifier for vApps.  Think about it like any version identifier for a Java or C# code file under source control (except that a vApp is more like 100 GB and of course a Java file is much smaller).  Every time you add a vApp into a catalog or submit it to OnDemand for certification testing, you must provide a unique vApp Build Version.</span>
    </P>
    <P/>
    <P>
        <span>“prep” is optional as explained below to help you determine the difference between a vApp in development verses a vApp in the catalog.</span>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>Provisioning a vApp/VM for an Engineering Build</span>
    </P>
    <P/>
    <P>
        <span>Now that you understand all the VM naming conventions, you can get started building some software!  This section will tell you how to properly check out a VM from the OnDemand catalog so you can install and test software for OnDemand use.</span>
    </P>
    <P>
        <span>All work done for an OnDemand build of VMs must take place in the OnDemand lab inside of VMware Cloud Director.  The OnDemand team will provision 2 organizations for your team, a …eng org and …qa org.  For example, say your registered product prefix is hlp, OnDemand would provision an “hlpeng” org and a “hlpqa” org.  The hlpeng org will have a public catalog in it.  The hlpqa org </span>
        <span>will not</span>
        <span> have a public catalog in it.  This will force you to clearly separate engineering activity from QA activity and also force you to properly test the provisioning of your application for a </span>
        <span>tenant</span>
        <span>.  You always start the process in the …eng organization.  You create builds of your software and check it into the public catalog in the …eng organization.  Building and testing your application in the …eng organization is all fine and dandy, but it is not a real test of your software.  You must </span>
        <span>use the …qa organization to check your vApp out from the catalog, rename it with a different environment identifier and </span>
        <span>tenant</span>
        <span> organization, and test the guest customization process we describe below to make sure you software can adapt itself to name changes required to keep it unique on the network.</span>
    </P>
    <P>
        <span>The OnDemand team has already created base VM templates for your use.  The only permitted operating systems to use at this time for managed server vApps are as follows</span>
        <span/>
        <span>(being upgraded to Datacenter Edition ASAP</span>
        <span>, upgrade instructions at the end of this document if you need a template before then</span>
        <span>)</span>
        <span>:</span>
    </P>
    <P>
        <span>Windows Server 2008 R2 </span>
        <span>SP1 </span>
        <span>Standard Edition 64-bit</span>
    </P>
    <P>
        <span>Windows Server 2008 R2 </span>
        <span>SP1 </span>
        <span>Standard Edition 64-bit with SQL Server 2008 R2 Standard Edition 64-bit</span>
    </P>
    <P>
        <span>The only permitted operating system to use at this time for managed desktop vApps is the following:</span>
    </P>
    <P>
        <span>Windows RDS Server 2008 R2 SP1 Standard Edition 64-bit</span>
    </P>
    <P>
        <span>A template for each of these servers is checked into the vCloud Director </span>
        <span>master</span>
        <span> catalog in the </span>
        <span>admin</span>
        <span> organization.</span>
    </P>
    <P>
        <span>To begin the vApp engineering process, first log into the …eng organization in vCloud Director.  Say your product prefix is again hlp, so your engineering org is hlpeng.  You would log into vCloud Director as follows in the lab:</span>
    </P>
    <P>
        <span>https://10.5.148.152/cloud/org/hlpeng</span>
    </P>
    <P>
        <span>Change the org at the end of the URL for your specific org as created for you by the OnDemand team.</span>
    </P>
    <P>
        <span>Next, switch to the My Cloud tab and then hit the big plus sign (+)</span>
        <span> under the vApps banner</span>
        <span>.   This will tell vCloud Director add a new vApp from the catalog.  Change the </span>
        <span>“</span>
        <span>Look in:</span>
        <span>”</span>
        <span> drop down to </span>
        <span>“</span>
        <span>public catalogs</span>
        <span>”</span>
        <span>.</span>
        <span>  Then change the next drop down (the filter drop down to the right) to “Catalog” and type “master” in the filter.  This will filter all the vApps across all the catalogs (there are lots from all the product builds) to just a set of templates in the master catalog, making it a lot easier to find the templates.</span>
    </P>
    <P>
        <span>For this exercise, let’s say we are create a database server to start our application build.  We need to pick the SQL</span>
        <span/>
        <span>Server template as follows:</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>Click Next.  Name the vApp a good name that people will immediately recognize as they test and put this vApp into production.  For example, say you are creating a managed server vApp for the HLP product version 5.0.  You have a GA release of your product version 5.0.  </span>
        <span>Now you also creating a vApp version.  You would start at 0.1 and go from there.  Also, you are preparing to create a catalog item, you haven’t created it yet.  So I like to name it this:</span>
    </P>
    <P>
        <span>Hlp 5.0 Managed Server v0.1 prep</span>
    </P>
    <P>
        <span/>
        <span>When you have tested this and are ready to check it into the catalog, then you name it:</span>
    </P>
    <P>
        <span>Hlp 5.0 Managed Server v0.1</span>
    </P>
    <P>
        <span>The “prep” part is gone.  You have fully prepared it and checked it into the catalog.  So everything in vCloud Director everywhere in the world has a unique and meaningful name.  vCloud Director doesn’t give you any more granularity than the single text string name, so make it count!  This single name will be used to track your </span>
        <span>vApp as we deploy it globally to hundreds of </span>
        <span>tenant</span>
        <span>s, so again, it is critical you always name your vApps very well.</span>
    </P>
    <P>
        <span>And don’t forget, after you check it in, you must update your …eng vApp name to v0.2 or you could have more than one v0.1 out there and have no idea what changes are in what catalog item.</span>
    </P>
    <P>
        <span>Next, you need to rename and network the VM.  Per naming conventions above, you don’t have a choice in the matter. Your product prefix is hlp.   You are creating a database server for a d1 environment.  You are in the hlpeng org. You must name it hlpdd11-hlpeng.  If you don’t know why, go back to the last section before proceeding.  If you get the name wrong, nothing will work, OnDemand won’t be able to provision your application for a </span>
        <span>tenant</span>
        <span>.  So this is a critical step and will always be a critical step for naming any VM in the world in OnDemand.</span>
    </P>
    <P>
        <span/>
        <span>Next, you must pick the right network from the drop down.  It should look something like this:</span>
    </P>
    <P/>
    <P>
        <span/>
        <span>Hit Next, Next, …, until the process is finished.  Then wait for the system to provision your vApp.  Do not start the vApp yet, you want to make sure guest customization is enabled and a new SID is generated.  So hang on until you can verify that per below:</span>
    </P>
    <P/>
    <P>
        <span>Every Windows VM on the network must have a unique SID.  Otherwise </span>
        <span>you</span>
        <span> can create a multitude of issues for yourself and for others using the environment.  So every time you check a VM out from a catalog, any time you copy a VM, any time you clone a VM, please make sure guest customization is enabled and you have the box checked above “Change SID”.  Then start up the vApp (or if provisioning a single VM inside a vApp, start the VM with the option “Power On and Force Recustomization”).  </span>
    </P>
    <P>
        <span>Next you have to be patient or you will waste many hours debugging a problem you probably created yourself.  After you start a VM provisioned/copied/cloned for the first time, let it run 30 minutes.  VMware will start a Windows sysprep process (described later) and if you try to log in and use the VM before it completes, you can corrupt the operating system.</span>
    </P>
    <P>
        <span>After 30 minutes is complete, log into the VM, make sure all the following was done:</span>
    </P>
    <P>
        <span>The host name was renamed properly</span>
    </P>
    <P>
        <span>The IP address is set properly (check the address vCloud Director assigned and make sure it is the same as the IP address inside the VM) and the network functions (try pinging the domain controller iigcf-dc1.iigcf.com)</span>
    </P>
    <P>
        <span>The VM joined the iigcf.com domain</span>
    </P>
    <P>
        <span>If any of these did not succeed, don’t install software.  Fix the problem first.  We have had engineers install significant amounts of software and not be able to provision the VM because they had a corrupt VM to begin with, so don’t waste your time with a bad base VM.</span>
    </P>
    <P>
        <span>Next, </span>
        <span>I strongly recommend</span>
        <span> you stop the VM and uncheck the </span>
        <span>Enable Guest Customization checkbox in the window above.  You </span>
        <span>must</span>
        <span> run </span>
        <span>guest customization</span>
        <span> one time to get the VM provisioned.  However, we have had engineers mistakenly leave this option enabled and run sysprep again at an inopportune time during the installation</span>
        <span> or configuration</span>
        <span> of their software.  It corrupted their VM and cost them many hours as the VM cannot be salvaged after a bad sysprep.  So get sysprep to run 1 time, run to finish, run successfully so all 3 items above function, and disable guest customization so it isn’t accidentally run again in your organization.</span>
    </P>
    <P>
        <span>Now you are good to go installing, configuring, and testing software!</span>
    </P>
    <P/>
    <P/>
    <P/>
    <P/>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>EMC OnDemand Environments</span>
    </P>
    <P/>
    <P>
        <span>EMC OnDemand </span>
        <span>provides a lab environment for vApp developers</span>
        <span> (and of course runs all of its production data centers)</span>
        <span>.  </span>
        <span>Each of these</span>
        <span> environments </span>
        <span>runs</span>
        <span> hundreds of </span>
        <span>infrastructure </span>
        <span>products</span>
        <span> from VMware, RSA, EMC, and Microsoft</span>
        <span>, enough infrastructure to run a data center of enterprise class applications.  They take months to set up.  As such, we cannot provide each team with their own dedicated development and testing environments.  We must share nicely (meaning please don’t delete or change other team’s work or the infrastructure itself, you could easily destroy months of work with a few mouse clicks!</span>
        <span>, and do not over-consume resources, please delete old vApps and stop any VMs you aren’t actively using, and provision disks small as we can easily grow them for customer use but we cannot easily contract them if you make them too big</span>
        <span>).</span>
    </P>
    <P>
        <span>Each instance of an EMC OnDemand environment (what we call a VCUBE Manager) has an important set of servers for vApp developers to know.  We have a naming convention for all of these servers as well, each server is prefixed by the </span>
        <span>VCUBE Manager ID (</span>
        <span/>
        <span>$</span>
        <span>{</span>
        <span>VCM_ID</span>
        <span>}</span>
        <span> variable in the portal provisioning system) and has a suffix of the domain (</span>
        <span/>
        <span>$</span>
        <span>{</span>
        <span>VCM_DOMAIN_NAME</span>
        <span>}</span>
        <span> variable in the portal provisioning system).</span>
    </P>
    <P>
        <span>EMC OnDemand Key Servers and Services</span>
    </P>
    <P/>
    <P>
        <span>In order</span>
        <span> for almost any meaningful vApp to function properly, you will need to know servers and services to hook up to.  For example, when provisioning a Windows VM, you need to know what domain controller to attach to, where the Active Directory/LDAP server is running, where the email server is, where the monitoring server is, and so on, so that your application is secured in the domain, attached to monitoring, and can send email messages and alerts.</span>
    </P>
    <P/>
    <P>
        <span>Domain Controller</span>
    </P>
    <P>
        <span>First of all you need to know information about the domain.  We have a primary domain controller that the vApps should connect to by default, it is named $</span>
        <span>{</span>
        <span>VCM_ID</span>
        <span>}</span>
        <span>-dc01.</span>
        <span>${VCM_TENANT_DOMAIN_NAME}</span>
        <span>.  For example, the Pleasanton lab has </span>
        <span>${VCM_ID}</span>
        <span> = uspl and </span>
        <span>${VCM_TENANT_DOMAIN_NAME}</span>
        <span> = </span>
        <span>iigcf.com</span>
        <span> so the name of this server in the Pleasanton lab is </span>
        <span>uspl</span>
        <span>-dc01.</span>
        <span>iigcf.com</span>
    </P>
    <P>
        <span>The domain controller also runs Active Directory on the standard ports and LDAP </span>
        <span>on the standard ports </span>
        <span>(both LDAP and LDAPS with a 3</span>
        <span>rd</span>
        <span> party signed strong certificate certified for OnDemand use).</span>
    </P>
    <P/>
    <P>
        <span>Hyperic Server</span>
    </P>
    <P>
        <span>Hyperic Enterprise is used to do deep application monitoring.  The main Hyperic server is named </span>
        <span>${VCM_ID}</span>
        <span>-hyperic</span>
        <span>01.</span>
        <span>${VCM_DOMAIN_NAME}</span>
        <span>.  For example, the Pleasanton lab has </span>
        <span>${VCM_ID}</span>
        <span> = uspl and </span>
        <span>${VCM_DOMAIN_NAME}</span>
        <span/>
        <span>= </span>
        <span>iigcf.com</span>
        <span> so the name of this server in the Pleasanton lab is </span>
        <span>uspl</span>
        <span>-hyperic</span>
        <span>01.</span>
        <span>iigcf.com</span>
    </P>
    <P/>
    <P>
        <span>Email Server</span>
    </P>
    <P>
        <span>You will want to use an email server to send operations alerts.  The main email server is named  </span>
        <span>--TBD--</span>
    </P>
    <P/>
    <P/>
    <P>
        <span>EMC OnDemand vApp Engineering Lab</span>
    </P>
    <P/>
    <P>
        <span>In Pleasanton, t</span>
        <span>he EMC OnDemand team maintains a hardware and software configuration very close to what is in production.  See below for specifics:</span>
    </P>
    <P/>
    <P>
        <span>EMC OnDemand Lab</span>
    </P>
    <P>
        <span>Domain Controller Server: </span>
        <span>uspl-dc01</span>
        <span>.iigcf.com</span>
    </P>
    <P>
        <span>Domain Name: iigcf.com</span>
    </P>
    <P>
        <span>Domain Controller (dc =iigcf, </span>
        <span>dc = com)</span>
    </P>
    <P>
        <span>Email Server: </span>
        <span>TBD</span>
    </P>
    <P>
        <span>vCloud Director: </span>
        <span>uspl-vcd01.iigcf.com</span>
    </P>
    <P/>
    <P>
        <span>Hyperic Server: uspl-hyperic01.iigcf.com</span>
    </P>
    <P/>
    <P>
        <span>Remote Desktop Server: uspl-rds01.iigcf.com</span>
    </P>
    <P>
        <span>This server is useful if you are an offshore developer and need optimized access to vCloud Director VM consoles.  The vCloud Director console is not optimized for remote access, it is very slow when compared with Microsoft RDS or VMware View desktops.  For better performance, contact the OnDemand team to grant you login access to this server, and then run vCloud Director consoles from this server.</span>
    </P>
    <P/>
    <P>
        <span>OnDemand Portal Server: uspl-portal.iigcf.com</span>
    </P>
    <P>
        <span>We are working to get this server exposed to vApp developers so they can test their vApps with the automation features of the portal!</span>
    </P>
    <P/>
    <P>
        <span>Hosts file aliases:</span>
    </P>
    <P/>
    <P>
        <span>10.8.96.51          uspl-vcd01.iigcf.com</span>
        <span>     # vCloud Director</span>
    </P>
    <P>
        <span>#</span>
        <span>TBD        </span>
        <span>        uspl-portal.iigcf.com</span>
        <span>    # EMC OnDemand automation portal</span>
    </P>
    <P>
        <span>10.8.96.84      </span>
        <span>    uspl-rds01.iigcf.com     </span>
        <span># RDS server jumpbox</span>
    </P>
    <P>
        <span>10.8.96.46          uspl-dc01.iigcf.com</span>
        <span>      # Domain controller</span>
    </P>
    <P/>
    <P>
        <span>For the development and testing of vApps in the lab, the OnDemand team will construct 2 vCloud Director organizations (VCUBEs) for you.  You will have a …eng org and a …qa org.  The …eng org will have </span>
        <span>some level of access to the Internet so that you can download and update software to install into your VMs.  The …eng org will also have </span>
        <span>a catalog.  This will allow you to save your vApp builds and share them to the …qa org or prepare them for extraction to the production data center.  The …qa org will not have a catalog</span>
        <span> and will not have access to the internet, as </span>
        <span>internet access is not allowed</span>
        <span> in production.  The …qa</span>
        <span> organization can provision applications stored in the eng org catalog and test them as if you were a </span>
        <span>real </span>
        <span>tenant</span>
        <span> in a production data center</span>
        <span>.</span>
    </P>
    <P/>
    <P>
        <span>EMC OnDemand Production Data Centers</span>
    </P>
    <P/>
    <P>
        <span>You should use the naming conventions above and the system parameters provided by the EMC OnDemand Portal (explained in subsequent sections) to construct host names and LDAP service parameters so that when your vApp comes up on the network in a production data center, that no manual configuration need </span>
        <span>be</span>
        <span> performed to get your vApp operational.  Please do not hesitate to ask the OnDemand team for help in this area as a little bit of work on your part could save a lot of work in the OnDemand operations team!</span>
    </P>
    <P/>
    <P/>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>Authentication and Authorization Guide</span>
    </P>
    <P/>
    <P>
        <span>OnDemand User Types</span>
    </P>
    <P>
        <span>EMC OnDemand applications have 3 classifications of users as follows:</span>
    </P>
    <P/>
    <P>
        <span>EMC OnDemand Administrators</span>
    </P>
    <P>
        <span>EMC employees and consultants</span>
        <span> managing the cloud environment</span>
        <span> with across to all VCUBEs and the </span>
        <span>VCUBE Manager stack of products.  </span>
    </P>
    <P>
        <span>In VCUBE terminology, these are called VCUBE Administrators.</span>
        <span/>
    </P>
    <P/>
    <P>
        <span>Customer Developers/Testers/Administrators/Users</span>
    </P>
    <P>
        <span>C</span>
        <span>ustomers or professional services on behalf of </span>
        <span>tenant</span>
        <span>s to develop</span>
        <span>, test,</span>
        <span> and administer solutions using products</span>
        <span> we provide in a VCUBE</span>
        <span>.  Also Customer End Users that require managed desktops (for example, to execute Captiva ScanPlus/IndexPlus).</span>
    </P>
    <P>
        <span>In VCUBE terminology, these are called Tenant Users.</span>
    </P>
    <P/>
    <P/>
    <P>
        <span>Large Populations of Customer End Users</span>
    </P>
    <P>
        <span>Customer End Users of </span>
        <span>VCUBE</span>
        <span> software/solutions that do not require managed desktops</span>
    </P>
    <P/>
    <P>
        <span>The users in </span>
        <span>green</span>
        <span> above are currently and exclusively managed by OnDemand.  In the future we will work to federate those users with a </span>
        <span>tenant</span>
        <span> LDAP system.  But today we must create a user and user groups/roles for that user in our OnDemand LDAP system and they will be different from the users in the </span>
        <span>tenant</span>
        <span>’s LDAP system.  Your server and desktop VMs must connect to our LDAP/Active Directory system to secure access to your software for user types 1 and 2 above.</span>
    </P>
    <P>
        <span>All users in </span>
        <span>green </span>
        <span>above are managed by user group based permissions.  Individual users in the OnDemand domain are </span>
        <span>not</span>
        <span> allowed to be used for any access right or ACL.  All access rights and shared file ACLs must be put in place through group permissions.</span>
    </P>
    <P>
        <span>The users in </span>
        <span>blue </span>
        <span>above </span>
        <span>are not managed by OnDemand.  They reside in a </span>
        <span>tenant</span>
        <span>’s LDAP system in a </span>
        <span>tenant</span>
        <span>’s data center.</span>
        <span>  The user types are shown in the diagram below.</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>All </span>
        <span>VMs must support the OnDemand identity management system and must secure files and installations using that identity management system.  In addition, managed servers may </span>
        <span>optionally </span>
        <span>reach out to a </span>
        <span>tenant</span>
        <span> LDAP system for user type #3.  Active</span>
        <span/>
        <span>Directory connection will not be supported</span>
        <span> for user type #3</span>
        <span> as this would require a trust relationship with a </span>
        <span>tenant</span>
        <span>’s domain controller which would compromise the VCUBE security model</span>
        <span>.</span>
        <span>  Only LDAP will be supported for user type #3</span>
        <span>.  Note that attaching to a </span>
        <span>tenant</span>
        <span>’s LDAP is not a requirement, but certainly is advantageous when your application </span>
        <span>supports large numbers of </span>
        <span>tenant</span>
        <span> end users.</span>
    </P>
    <P/>
    <P>
        <span>OnDemand Active Directory/LDAP Structure</span>
    </P>
    <P/>
    <P>
        <span>OnDemand</span>
        <span> runs Microsoft Active Directory (provided by Windows Server 2008) as its identity management system.  We have enabled LDAP and LDAPS on this server so that your VMs can connect using </span>
        <span>your choice of </span>
        <span>native Microsoft Active Directory APIs, LDAP, or LDAPS protocols.  </span>
        <span>See below for information on the system account you must use when connecting to the directory service.</span>
    </P>
    <P>
        <span>The overall structure o</span>
        <span>f the directory service follows, items highlighted in </span>
        <span>red</span>
        <span/>
        <span>are important for application teams to understand and work with.</span>
    </P>
    <P>
        <span>OU= Groups</span>
    </P>
    <P>
        <span>The</span>
        <span> Groups OU is a standard Active Directory OU which will house all the groups used by VCUBE Manager and any VCUBE software requiring user type #1 or #2 access.</span>
    </P>
    <P/>
    <P>
        <span>OU=</span>
        <span>Apps</span>
    </P>
    <P>
        <span>This</span>
        <span> OU houses global roles for each </span>
        <span>application</span>
        <span> offered in OnDemand.  You must have the OnDemand team create an OU for your product and populate that OU for all the standard/default roles you will use to access your application and provide group/role based security in our application.</span>
        <span>  The group name can be </span>
        <span>no longer than </span>
        <span>40</span>
        <span> characters</span>
        <span> and must be globally unique throughout all of OnDemand and therefore very descriptive of your application and your application only.</span>
        <span>  There can be only one application name per product (the &lt;product&gt; part of naming your VMs).</span>
        <span>  This group name is likely to be seen in pick lists so you should give it a name users will understand and will look good in end user interfaces.</span>
    </P>
    <P>
        <span>OU = xPression</span>
    </P>
    <P>
        <span>OU = Captiva</span>
    </P>
    <P>
        <span>OU = Documentum</span>
    </P>
    <P>
        <span>……………………………….</span>
    </P>
    <P>
        <span>The description attribute for each of these groups </span>
        <span>must</span>
        <span> begin wi</span>
        <span>th the name of your application.  There could be thousands of roles eventually in our identity management system, so please name your roles uniquely, consistently across your application, and populate the description attribute so they can be filtered in pick lists.  Some examples for xPression follow:</span>
    </P>
    <P/>
    <Table>
        <Tr>
            <Td>
                <P>
                    <span>Group Name</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>“description” attribute</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xAdmin Users</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xAdmin user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xDash</span>
                    <span>boa</span>
                    <span>rd Users</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xDash</span>
                    <span>boa</span>
                    <span>rd user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xDesign Users</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xDesign user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xPresso for Word Users</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xPresso for Word user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xResponse Users</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xResponse user group</span>
                </P>
            </Td>
        </Tr>
    </Table>
    <P/>
    <P>
        <span>Note that the VCUBE Manager portal manages this OU and anything created as child OUs.  Manipulating this OU, groups in this OU, or </span>
        <span>creating OUs</span>
        <span> under this OU outside of the portal user interface is not recommended as it could cause significant operational issues with the portal.  Please use the portal to make changes to this OU.</span>
    </P>
    <P/>
    <P>
        <span>OU = Employees</span>
    </P>
    <P>
        <span>This OU will be used to house user accounts for OnDemand employees and consultants (user type #1 above).</span>
    </P>
    <P/>
    <P>
        <span>OU = EMC</span>
        <span> Admin</span>
    </P>
    <P>
        <span>User accounts</span>
        <span> of EMC employees</span>
        <span> and consultants</span>
        <span> who would be responsible for managing </span>
        <span>the OnDemand environment.  Examples of EMC users are the server and desktop domain administrators, VMware stack administrators, VCUBE Manager portal administrators and fulfillment/provisioning specialists.</span>
    </P>
    <P/>
    <P>
        <span>Note that the VCUBE Manager portal manages this OU and anything created as child OUs.  Manipulating this OU, </span>
        <span>users</span>
        <span> in this OU, or </span>
        <span>OUs</span>
        <span> under this OU outside of the portal user interface is not recommended as it could cause significant operational issues with the portal.  Please use the portal to make changes to this OU.</span>
        <span>  Assigning groups to users in this OU is perfectly safe and expected in this release of the portal.</span>
    </P>
    <P/>
    <P/>
    <P>
        <span>OU = Customers</span>
    </P>
    <P>
        <span>This OU</span>
        <span> will be used to house </span>
        <span>anything specific to a </span>
        <span>tenant</span>
        <span> (user type #2 above).  Each </span>
        <span>tenant</span>
        <span> will have their own OU, plus w</span>
        <span>e have a …eng and a …qa </span>
        <span>OU which we use to </span>
        <span>engineer and QA test</span>
        <span> the templates </span>
        <span>to make sure they </span>
        <span>work properly before provisioning to a </span>
        <span>real </span>
        <span>tenant</span>
        <span>’s VCUBE</span>
        <span>.</span>
        <span>  Every </span>
        <span>tenant</span>
        <span> will have a tree structure inside their OU for users, system accounts (domain accounts required by various software packages to run properly), </span>
        <span>tenant</span>
        <span>-specific custom groups, and desktop pool</span>
    </P>
    <P/>
    <P>
        <span>Note that the VCUB</span>
        <span>E Manager portal manages a significant portion of this OU.  Some of this OU is not managed in the current release of the portal.  Please read below to see exactly which OUs are managed and which portions thereof.</span>
    </P>
    <P/>
    <P>
        <span>OU = </span>
        <span>xxx</span>
        <span>eng </span>
        <span>–</span>
        <span>or</span>
        <span>-</span>
        <span/>
        <span>xxx</span>
        <span>qa</span>
    </P>
    <P>
        <span>This would be the name of the …eng or …qa organization the OnDemand team set up for you as a vA</span>
        <span>pp engineering or testing VCUBE in the lab, or it would be an actual 2-6 character name of a </span>
        <span>tenant</span>
        <span> in production.  This name must be all lower case, be globally unique (at least per instance of VCUBE Manager), and start with an alphabetic character.</span>
    </P>
    <P/>
    <P>
        <span>OU=Users</span>
    </P>
    <P>
        <span>This OU</span>
        <span> is </span>
        <span>used to contain</span>
        <span> all the users fo</span>
        <span>r user type #2 pertinent to a</span>
        <span> particular </span>
        <span>tenant</span>
        <span>.  Applications must create an OU filter to make sure only users in this OU (relative to the </span>
        <span>tenant</span>
        <span> the software is provisioned to of course) are allowed to log in and be available for pick lists.</span>
    </P>
    <P/>
    <P>
        <span>Note that the VCUBE Manager portal manages this OU and anything created as child OUs.  Manipulating this OU, </span>
        <span>users</span>
        <span> in this OU, or </span>
        <span>OUs</span>
        <span> under this OU outside of the portal user interface is not recommended as it could cause significant operational issues with the portal.  </span>
        <span>This particularly includes group membership (assigning or removing groups to users in this OU).  </span>
        <span>Please use the portal to make changes to this OU</span>
        <span> or to add or remove any groups to users in this OU</span>
        <span>.</span>
    </P>
    <P/>
    <P>
        <span>OU=ServiceAccts</span>
    </P>
    <P>
        <span>This OU</span>
        <span> contains all the service accounts for this particular </span>
        <span>tenant</span>
        <span>.  Many applications require Windows services to be run with a domain account.  For security reasons, we cannot just have one global domain administrator account with a particular name and password available to run software.  That account could be compromised, resulting in every VCUBE of software to be compromised.  Instead, </span>
        <span>each VCUBE for each </span>
        <span>tenant</span>
        <span>, where required to run a service account, must use a service account in this OU specifically provisioned for this OU.  VCUBE software can count on the following service accounts to be automatically provisioned for them:</span>
    </P>
    <P/>
    <P>
        <span>ldapsvcacct-&lt;</span>
        <span>tenant</span>
        <span> OU&gt;</span>
        <span>  (for example, ldapsvcacct-dtmeng</span>
        <span> in the </span>
        <span>dtmeng</span>
        <span> OU)</span>
    </P>
    <P>
        <span>This account will not be allowed to log into desktop or server operating systems.  It will simply have permission to </span>
        <span>browse the LDAP directory to retrieve the groups (OU=Groups) and the </span>
        <span>tenant</span>
        <span> OU (OU=Customers, OU=&lt;</span>
        <span>tenant</span>
        <span> OU&gt;) part of LDAP.  This account will not be allowed to browse outside of those areas.</span>
    </P>
    <P/>
    <P>
        <span>Note that the VCUBE Manager portal creates this OU (if it was not already created), but it will not manage it.</span>
        <span> It is perfectly safe and expected that </span>
        <span>service account </span>
        <span>users and groups for those users will be created and managed outside of the portal in this release of the portal.</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>OU=CustomGroups</span>
    </P>
    <P>
        <span>This OU</span>
        <span> contains all the groups for user type #2 pertinent to that particular </span>
        <span>tenant</span>
        <span>.</span>
    </P>
    <P/>
    <P>
        <span>Note that the VCUBE Manager portal manages this OU and anything created as child OUs.  Manipulating this OU, groups in this OU, or groups under this OU outside of the portal user interface is not recommended as it could cause significant operational issues with the portal.  Please use the portal to make changes to this OU.</span>
    </P>
    <P/>
    <P>
        <span>Applications</span>
        <span> (vApps)</span>
        <span/>
        <span>must</span>
        <span> create </span>
        <span>LDAP filters when querying for groups in pick lists.  The filter must include OU, name, or description filter criteria</span>
        <span> to make sure only groups in the global groups OU above (Groups\Apps\&lt;application&gt;) and this custom group OU (relative to the </span>
        <span>tenant</span>
        <span> the software is provisioned to of course) are allowed to be available for pick lists.</span>
        <span>  Note that this OU is valid across </span>
        <span>all applications</span>
        <span/>
        <span>but not across </span>
        <span>tenant</span>
        <span>s, (these are </span>
        <span>tenant</span>
        <span>-specific groups under a </span>
        <span>tenant</span>
        <span>-specific OU).  So we would strongly recommend you employ a description filter in your pick lists!</span>
    </P>
    <P/>
    <P>
        <span>OnDemand supports 3</span>
        <span> dif</span>
        <span>ferent types of custom groups:</span>
    </P>
    <P>
        <span>Prod/Non-Prod Specific Groups</span>
    </P>
    <P>
        <span>Environment Specific Groups</span>
    </P>
    <P>
        <span>Tenant Specific Custom Groups</span>
    </P>
    <P/>
    <P>
        <span>Prod/Non-Prod Specific Groups</span>
    </P>
    <P/>
    <P>
        <span>The first type of group is a custom group that is environment </span>
        <span>type </span>
        <span>specific.  Customers commonly have different people working with production environments than non-production environments.  OnDemand must be able to have different groups to manage production and non-production environments.</span>
        <span/>
        <span>Customers could have 3 non-prod environments and want to have the same administrator working across all 3 non-prod environments (sandbox 1, dev 1, test 1), but then have a different administrator working on 2 production environments (prod 1 and prod 2).  This type of group will handle this scenario.</span>
    </P>
    <P/>
    <P>
        <span>OnDemand will handle this by copying the application global groups into this OU and appending a unique identifier to the end (both the tenant OU plus </span>
        <span>either “prod” or </span>
        <span>“nonprod”</span>
        <span>).  For example, say tenant “boa” wanted to lock down production environment</span>
        <span>s</span>
        <span> for the application xPression with the roles documented above.  The VCUBE Manager portal would then create the following groups in the OU=CustomGroups,OU=boa,OU=Customers part of the Active Directory tree:</span>
    </P>
    <P/>
    <Table>
        <Tr>
            <Td>
                <P>
                    <span>Group Name</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>“description” attribute</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xAdmin Users-prod-boa</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xAdmin user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xDashboard Users-prod-boa</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xDashboard user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xDesign Users-prod-boa</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xDesign user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xPresso for Word Users-prod-boa</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xPresso for Word user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xResponse Users-prod-boa</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xResponse user group</span>
                </P>
            </Td>
        </Tr>
    </Table>
    <P/>
    <P>
        <span>In this example, all the global roles in the OU=xPression,OU=Apps,OU=Groups part of the LDAP tree would be copied and appended with the unique identifier “</span>
        <span>-prod</span>
        <span>-boa</span>
        <span>” to reflect that we are locking things down for the xPression </span>
        <span>production</span>
        <span> environment</span>
        <span>s</span>
        <span> for the “boa” </span>
        <span>tenant</span>
        <span>.  The SwitchVMGroups script must be</span>
        <span> run on all of the relevant prod</span>
        <span> environment VMs to switch from the set of global groups to the set of tenant</span>
        <span>/prod</span>
        <span> specific set of groups.</span>
    </P>
    <P/>
    <P>
        <span>Environment Specific Groups</span>
    </P>
    <P/>
    <P>
        <span>The second type of </span>
        <span>custom </span>
        <span>group is very specific to a particular tenant and environment.  For example, the customer wants to lock down the “p1” environment.  They may have a “p2” environment and they don’t want people with permission to access both p1 and p2 (which would happen above if they received “prod” permission</span>
        <span> above</span>
        <span>).</span>
    </P>
    <P/>
    <P>
        <span>OnDemand will handle this by copying the application global groups into this OU and appending a unique identifier to the end (both the </span>
        <span>tenant</span>
        <span> OU plus the 2 character environment ID).  For example, say </span>
        <span>tenant</span>
        <span> “boa” wanted to lock down production environment “p1” for the application xPression with the roles documented above.  The VCUBE Manager portal would then create the following groups in the OU=CustomGroups,OU=boa,OU=Customers part of the Active Directory tree:</span>
    </P>
    <P/>
    <Table>
        <Tr>
            <Td>
                <P>
                    <span>Group Name</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>“description” attribute</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xAdmin Users-p1-boa</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xAdmin user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xDashboard Users-p1-boa</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xDashboard user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xDesign Users-p1-boa</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xDesign user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xPresso for Word Users-p1-boa</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xPresso for Word user group</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>xResponse Users-p1-boa</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>xPression xResponse user group</span>
                </P>
            </Td>
        </Tr>
    </Table>
    <P/>
    <P>
        <span>In this example, all the global roles in the OU=xPression,OU=Apps,OU=Groups part of the LDAP tree would be copied and appended with the unique identifier “</span>
        <span>-p1-boa</span>
        <span>” to reflect that we are locking things down for the xPression “p1” environment for the “boa” VCUBE.  The SwitchVMGroups script must be run on all of the relevant “p1” </span>
        <span>environment VMs to switch from the set of global groups to the set of </span>
        <span>tenant</span>
        <span>/environment specific set of groups.</span>
    </P>
    <P/>
    <P>
        <span>Tenant Specific Custom Groups</span>
    </P>
    <P/>
    <P>
        <span>The </span>
        <span>third</span>
        <span> type of group is a custom group that isn’t application or environment specific.  The case for this type of group is when a </span>
        <span>tenant</span>
        <span> doesn’t think our out of the box global groups are granular enough or named to reflect the business process.  For example, say you have an insurance workflow in Documentum.  A </span>
        <span>tenant</span>
        <span> submits a claim and it is sent to a claims adjuster, and once all the required information is submitted the claim is sent to a claims supervisor.  The </span>
        <span>tenant</span>
        <span> wants to see a group in OnDemand named “Claims Adjuster” and another one named “Claims Supervisor”.  To keep the names </span>
        <span>tenant</span>
        <span> specific, we need to append them with the name</span>
        <span> of the Customer OU.  For “boa”, the names would be:</span>
    </P>
    <P>
        <span>Claims Adjuster-boa</span>
    </P>
    <P>
        <span>Claims Supervisor-boa</span>
    </P>
    <P/>
    <P>
        <span>OU=DesktopPools</span>
    </P>
    <P>
        <span>This OU</span>
        <span> is a dynamic OU managed by the VCUBE Manager portal.  It is used to maintain a mapping of users to applications running on managed desktops.  Application teams will not work on this OU.</span>
    </P>
    <P/>
    <P>
        <span>The format for this group name is </span>
        <span>“View “</span>
        <span> + &lt;application name from the ou=Apps,ou=Groups area</span>
        <span>&gt; + “ Desktop-“ + &lt;viewPoolID</span>
        <span> which matches the VM naming conventions for a provisioned Desktop View Pool</span>
        <span>&gt; + “-“ + &lt;</span>
        <span>tenant</span>
        <span> ID&gt;</span>
        <span>.  For example, say we have a pool o</span>
        <span>f xPression desktops named xprrza01-chubb and xprrz</span>
        <span>a02-chubb.  The DesktopPool group would be named “</span>
        <span>View </span>
        <span>xPression Desktop-za-</span>
        <span>chubb” so that it is globally unique in OnDemand.</span>
    </P>
    <P/>
    <P>
        <span>Note that the VCUBE Manager portal manages this OU and anything created as child OUs.  Manipulating this OU, groups in this OU, or groups under this OU outside of the portal user interface is not recommended as it could cause significant operational issues with the portal.  Please use the portal to make changes to this OU.</span>
    </P>
    <P/>
    <P/>
    <P>
        <span>(examples of tenant OUs follow)</span>
    </P>
    <P/>
    <P>
        <span>OU = </span>
        <span>boa</span>
    </P>
    <P>
        <span>OU for a </span>
        <span>tenant</span>
        <span> with a shortened name of “</span>
        <span>boa</span>
        <span>”</span>
    </P>
    <P>
        <span>OU=Users</span>
    </P>
    <P>
        <span>OU=ServiceAccts</span>
    </P>
    <P>
        <span>ldapsvcacct-</span>
        <span>boa</span>
        <span> in the </span>
        <span>boa</span>
        <span> OU</span>
    </P>
    <P>
        <span>OU=CustomGroups</span>
    </P>
    <P>
        <span>OU=DesktopPools</span>
    </P>
    <P/>
    <P>
        <span>OU = </span>
        <span>wellsf</span>
    </P>
    <P>
        <span>OU for a </span>
        <span>tenant</span>
        <span> with a shortened name of “</span>
        <span>wellsf</span>
        <span>”</span>
    </P>
    <P/>
    <P>
        <span>OU=Users</span>
    </P>
    <P>
        <span>OU=ServiceAccts</span>
    </P>
    <P>
        <span>ldapsvcacct-</span>
        <span>wellsf</span>
        <span> in the </span>
        <span>wellsf</span>
        <span> OU</span>
    </P>
    <P>
        <span>OU=CustomGroups</span>
    </P>
    <P>
        <span>OU=DesktopPools</span>
    </P>
    <P/>
    <P>
        <span>……………………</span>
    </P>
    <P/>
    <P>
        <span>Where possible, the application must take great care to allow only users of the particular </span>
        <span>tenant</span>
        <span> OU to log into their servers.  For example, say that we provision your application for </span>
        <span>tenant</span>
        <span/>
        <span>wellsf</span>
        <span>.  You should set your LDAP OU filter to only allow users from the </span>
        <span>“</span>
        <span>OU=</span>
        <span>wellsf</span>
        <span>,OU=Customers,</span>
        <span>dc</span>
        <span>=iigcf,</span>
        <span>dc</span>
        <span>=com</span>
        <span>”</span>
        <span> part of the LDAP tree.  Otherwise someone with credentials from the </span>
        <span>boa</span>
        <span/>
        <span>tenant</span>
        <span> or other </span>
        <span>tenant</span>
        <span>s defined in other portions of the LDAP tree could log into your application and obtain the access rights they have defined for their own VCUBE of software.  Remember that this is a shared Active Directory/LDAP across every VCUBE in the world, so your software must be set to restrict access appropriately.</span>
    </P>
    <P>
        <span>When you test your system</span>
        <span> in say the xxxeng org</span>
        <span>, you want to filter your OU to “OU=</span>
        <span>xxxeng</span>
        <span>,OU=Customers,dc=iigcf,dc</span>
        <span>=com</span>
        <span>”.  Then when you get a provisioning request to create an environment for a </span>
        <span>tenant</span>
        <span> named “</span>
        <span>boa</span>
        <span>”, you would change your filter to “OU=</span>
        <span>boa</span>
        <span>,OU=Customers,dc=iigcf,dc</span>
        <span>=com</span>
        <span>”.</span>
    </P>
    <P/>
    <P>
        <span>Securing Your VMs</span>
    </P>
    <P/>
    <P>
        <span>EMC OnDemand will follow best practices for securing VMs in a VCUBE.  At a very high level, this means no one can log into a </span>
        <span>tenant</span>
        <span>’s VCUBE without being tracked to a specific userid.  All userids will have a password that expires.   </span>
        <span>Administrator accounts will be available to install your software.  Service accounts will be made available as well.  But per above the passwords will expire and you must provide documented instructions at a minimum so that passwords for any/all system accounts you require can be changed before they expire (scripts to change passwords is strongly advised).  </span>
        <span>These two simple statements have huge repercussions for how we install, run, and administer our software.</span>
    </P>
    <P/>
    <P>
        <span>Installation</span>
        <span> and Execution</span>
        <span> Account Considerations</span>
    </P>
    <P/>
    <P>
        <span>What appears to work well so far is if you install your software under the local administrator account (credentials supplied by the OnDemand team).  Install the software so that any user of the software could use that software (this is particularly important for managed desktops, you will never be able to know the user in advance so the software needs to work for any user</span>
        <span> permitted to log into that desktop</span>
        <span>).  </span>
    </P>
    <P>
        <span>For any Windows Services you install</span>
        <span>, try to </span>
        <span>run as Local System or Network Service.</span>
        <span>  Those accounts do not require updates as we change from one data center to another (iigcf domain to the ondemand.emc.com domain) and to not require password updates when the passwords expire.</span>
    </P>
    <P>
        <span>If a service account is required, notify the OnDemand team.  We can create service accounts as long as you have a documented (and hopefully scripted) method to change the service account at provisioning time and password expiration time (the account cannot be global across VCUBEs, it must be domain and </span>
        <span>tenant</span>
        <span> OU specific).  Also service accounts must never be allowed to log into a server (as that account can be compromised and create an entry for untracked changes to the environment).</span>
    </P>
    <P/>
    <P>
        <span>Operating System ACL Considerations</span>
    </P>
    <P/>
    <P>
        <span>Managed servers will be locked down so that only domain account administrators can log into them or open root drive shares to them.</span>
        <span>  However, you will need to expose file shares to the server for a number of reasons (log files, input and output files).  OnDemand would ask that you put all files you want shared in a central place on the C: drive or the D: drive named Shared.  Lock that Windows file share down so that only members of a </span>
        <span>local user group</span>
        <span> can access it.  Remember that nothing on any VMs can be tied to particular users, everything must be group-based.</span>
    </P>
    <P>
        <span>The next question you may ask is why a “local” user grou</span>
        <span>p.  Why not a domain user group?</span>
        <span>  The reason you don’t want to use a domain user group is that the domain can and </span>
        <span>will</span>
        <span> change.  The lab domain is different than the production data center domain.  So if you create a series of operating system ACLs on folders and files, and tie them to groups in the domain user group, your VM will not work correctly in a different domain.</span>
    </P>
    <P>
        <span>For xPression, we have the need for several different types of users to access the shared folder on the server.  We created a group for each user:</span>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>These groups are all local groups.  They will only take effect inside that VM (but when the VM is cloned and renamed, the groups come along for the ride automatically, which is pretty cool).  Next, for each of these groups, add a member that is the exact same name but in the lab iigcf domain:</span>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>Now we can assign ACLs for file permissions, FTP access, and so on, using the </span>
        <span>local</span>
        <span> groups:</span>
    </P>
    <P/>
    <P>
        <span>Notice that the group does not come from the domain, but the local machine which in this case is XPRAD11.</span>
        <span/>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>FTP permissions can be assigned to the local groups as well, as can many other items on the operating system.  If you follow this pattern, then when we switch domains to move your VMs to a different data center, local group membership can be easily switched from the old IIGCF domain to the new domain with some pretty simple scripts we can provide for you.</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>Customer Data and Data-At-Rest Encryption</span>
    </P>
    <P/>
    <P>
        <span>In order to get started quickly and minimize the amount of work required to get vApps running</span>
        <span> in year 2011</span>
        <span>, EMC OnDemand did not </span>
        <span>previously </span>
        <span>have requirements as to where </span>
        <span>tenant</span>
        <span> data is placed in VM drives.  The best practice for Windows operating systems is to install products and place data on a drive that is not the operating system boot drive.  The reason for this is the operating system install/boot drive needs to be protected from </span>
        <span>application</span>
        <span/>
        <span>temp file, </span>
        <span>data</span>
        <span>,</span>
        <span> and log file growth</span>
        <span> completely filling the drive critical to keeping the operating system functional</span>
        <span>.  If the </span>
        <span>primary </span>
        <span>operating system drive runs out of disk space, the operating system crashes and cannot be booted.</span>
        <span>  For this reason, savvy </span>
        <span>tenant</span>
        <span>s of our products typically make us install our products on a D: drive (and place all their database files and logs on the D: drive as well).  OnDemand is now requiring any/all </span>
        <span>tenant</span>
        <span> data files to use this approach</span>
        <span> (but not necessarily product installation files)</span>
        <span>.  </span>
    </P>
    <P/>
    <P>
        <span>We need to convert to this </span>
        <span>vApp </span>
        <span>design not only conform to Windows operating system best practices but also to make it easier and more efficient to implement data-at-rest encryption.</span>
        <span>  Many potential </span>
        <span>tenant</span>
        <span>s are asking OnDemand to encrypt sensitive data both in-transit and at-rest.  In-transit data is typically taken care of by our vA</span>
        <span>pps enabling https and secure F</span>
        <span>T</span>
        <span>P</span>
        <span>.  </span>
        <span>Unfortunately</span>
        <span> data-at-rest encryption is a great deal more complex.</span>
        <span>  Most data-at-rest encryption providers do not have the capability to just encrypt particular files or directories.  They can encrypt at a whole drive level only.  </span>
    </P>
    <P/>
    <P>
        <span>Therefore the </span>
        <span>easiest </span>
        <span>compromise in vApp design</span>
        <span> to accomplish both a best practice operating system install and provide confidence on </span>
        <span>tenant</span>
        <span> data-at-rest encryption is to require </span>
        <span>at a minimum </span>
        <span>that </span>
        <span>all vApps be designed to place any </span>
        <span>tenant</span>
        <span> data on a D: drive</span>
        <span>.</span>
        <span>  It is not easy to determine what data is or is not sensitive, particularly when EMC OnDemand is not in control of the solution </span>
        <span>tenant</span>
        <span>s deploy.</span>
        <span/>
        <span>Therefore all </span>
        <span>data files, databases, database log files, application server log files, temporary working data files, and any other file that </span>
        <span>could potentially contain</span>
        <span/>
        <span>tenant</span>
        <span> data</span>
        <span> must be installed to place the data on the D: drive</span>
        <span>.</span>
    </P>
    <P/>
    <P>
        <span>When creating  D: drive, pay particular attention to the type of disk partition you create.  It </span>
        <span>must be an MBR type disk partition</span>
        <span>.  GPT disk partitions have a lot of advantages over MBR but unfortunately they do not work properly with EMC backup technology and therefore are not supported in EMC OnDemand!</span>
        <span>  If you have a GPT type disk partition, please contact the OnDemand team to convert it to MBR, we have a good set of instructions to make this pretty easy to switch.</span>
    </P>
    <P/>
    <P>
        <span>Some applications have already implemented this best practice for other reasons and have found a significant side effect when doing so.  When you clone a VM to provision it, the operation system boot drive ACLs survive the cloning process.  All the ACLs on the C: drive </span>
        <span>function properly</span>
        <span>.  Unfortunately, all the ACLs on the D: drive are unresolved SIDs.  Therefore if you need ACLs on the D: drive (which you will at a minimum require for any shared file</span>
        <span>) you must code a script to put the ACLs in place during guest customization.  Check with the OnDemand team if you would like scripts that jump start this task.</span>
    </P>
    <P/>
    <P>
        <span>Finally, we have found some application VMs, particularly desktop VMs, that cannot redirect all </span>
        <span>tenant</span>
        <span> data files to a D: drive.  The Windows operating system may require the files to be placed on the boot drive in a specific folder set up by the operating system.  Check with the OnDemand team for a waiver of this standard in such cases.  OnDemand will then encrypt the entire C: drive (or maybe select portions of the C: drive if such technology is available) and should you get agreement, you will not need to create a D: drive if that does not make sense.</span>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>Dynamic Provisioning Guide</span>
    </P>
    <P/>
    <P>
        <span>Creating a VMware image or even a vApp of networked images to run an EMC product is a relatively routine matter.  You name the VMs up front, you put the names in the various installation programs, and the products install themselves with these names in INI files, properties files, database tables, and such.</span>
    </P>
    <P>
        <span>Unfortunately that leaves you with a static VM or vApp template that cannot be provisioned for </span>
        <span>tenant</span>
        <span> use.  As stated above, everything must be uniquely named in the OnDemand environment or it will conflict on the network.  All VMs in OnDemand share the same network and the same VCUBE Manager (Active Directory domain, DNS, …) manages every VM and every userid in the entire system.  Therefore the server naming conventions above must be strictly adhered to as well as the </span>
        <span>tenant</span>
        <span>/environment provisioning process.  Your VM template must accommodate dynamic provisioning and unique VM renaming during the provisioning process or you will not be allowed to run in OnDemand as the VM names would collide and corrupt the OnDemand environment.</span>
    </P>
    <P>
        <span>Provisioning Overview</span>
    </P>
    <P>
        <span>Below is an example of how we would provision a simple xPression application </span>
        <span>consisting </span>
        <span>of </span>
        <span>a single 2 server vApp and single</span>
        <span> desktop </span>
        <span>vApp</span>
        <span>:</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>In this example, we have a Server vApp that is checked into the VMware Cloud Director catalog.  That vApp is fully tested and complies with all the standards in this guide.  It has 2 VM servers in the vApp, a data</span>
        <span>base server named XPRDD11</span>
        <span>-xpreng</span>
        <span> and an application server named XPRAD11</span>
        <span>-xpreng</span>
        <span>.  These servers are named for template testing only.  During the </span>
        <span>tenant</span>
        <span> provisioning process, they must rename themselves to be unique for the </span>
        <span>tenant</span>
        <span> and type of environment requested.  The above provisioning process made 4 server provisioning requests:</span>
    </P>
    <P>
        <span>xPression DEV1</span>
        <span> (D1 environment ID)</span>
        <span> environment for </span>
        <span>boa</span>
        <span/>
        <span>tenant</span>
    </P>
    <P>
        <span>xPression SANDB1</span>
        <span> (S1 environment ID)</span>
        <span> environment for </span>
        <span>boa</span>
        <span/>
        <span>tenant</span>
    </P>
    <P>
        <span>xPression TEST1</span>
        <span> (T1 environment ID)</span>
        <span> environment for </span>
        <span>boa</span>
        <span/>
        <span>tenant</span>
    </P>
    <P>
        <span>xPression PROD1 (P1 environment ID) environment for </span>
        <span>boa</span>
        <span/>
        <span>tenant</span>
    </P>
    <P/>
    <P>
        <span>For #1, the xPression VMs must be intelligent enough to know that they must change any reference to the name </span>
        <span>xprdd11</span>
        <span>-xpreng</span>
        <span> to be the name </span>
        <span>xprdd11</span>
        <span>-</span>
        <span>boa</span>
        <span>, and change any reference to the name </span>
        <span>xprad11</span>
        <span>-xpreng</span>
        <span> to be the </span>
        <span>name </span>
        <span>xprad11</span>
        <span>-</span>
        <span>boa</span>
        <span>.</span>
        <span>  Therefore, when a </span>
        <span>boa</span>
        <span> user logs into one of the web based user interfaces on the application server </span>
        <span>xprad11</span>
        <span>-</span>
        <span>boa</span>
        <span>, that server runs properly, connects properly to the database server named </span>
        <span>xprdd11</span>
        <span>-</span>
        <span>boa</span>
        <span>, and all is good.</span>
    </P>
    <P>
        <span>For #2, the xPression VMs must be intelligent enough to know that they must change any reference to the name </span>
        <span>xprdd11</span>
        <span>-xpreng</span>
        <span> to be the name </span>
        <span>xprds11</span>
        <span>-</span>
        <span>boa</span>
        <span>, and change any reference to the name </span>
        <span>xprad11</span>
        <span>-xpreng</span>
        <span> to be the name </span>
        <span>xpras11</span>
        <span>-</span>
        <span>boa</span>
        <span>.  And so on for #3 and #4.  And don’t forget about any other server names as well like the connection to the Documentum Docbroker</span>
        <span> on </span>
        <span>dtmcs11</span>
        <span>-</span>
        <span>boa</span>
        <span>.</span>
    </P>
    <P>
        <span>Desktop pool provisioning is a bit different.  Desktops cross server environments (you don’t have a Dev desktop, you have a desktop that can con</span>
        <span>nect to Dev, or Test, or any other environment in the VCUBE</span>
        <span> that matches the level of the software of that desktop</span>
        <span>).  So a desktop pool does not have an environment identifier in i</span>
        <span>ts name, but instead has an</span>
        <span> instance number (to allow for </span>
        <span>many managed desktop RDS servers</span>
        <span>), and of course must append the name of the </span>
        <span>tenant</span>
        <span> to keep them unique on the network.</span>
    </P>
    <P/>
    <P>
        <span>Provisioning Mechanism</span>
    </P>
    <P>
        <span>VMware has some built-in capabilities to help us automate this provisioning </span>
        <span>and renaming process.  </span>
        <span>We call this process “clone and fix” because we </span>
        <span>clone</span>
        <span> one or more VMs (a vApp) out of a catalog of pre-built and pre-tested VMs and then we have to </span>
        <span>fix</span>
        <span> them after the cloning process or they will not work properly.  Fixing involves at least the following:</span>
    </P>
    <P>
        <span>For Windows VMs, we need to create a new SID (Windows System IDentifier).  If we do not create a new SID for each VM, there will be duplicate SIDs on the network and that will cause all kinds of problems.  Creating a new SID is done for us when we use vCloud Director guest customization and check the correct box.</span>
    </P>
    <P>
        <span>We need to change the VM names to be correct inside the particular VCUBE we are provisioned the vApp into and the correct environment as well.</span>
    </P>
    <P>
        <span>We need to change IP addresses to match what vCloud Director allocated to us.</span>
    </P>
    <P>
        <span>We need to switch domains.  We cannot assume that the VM is running in the same domain that it was originally tested in.  Deployment of a vApp into a production data center will definitely change the domain.</span>
    </P>
    <P>
        <span>We need to switch the tenant OU from the original xxxeng org tenant OU that it was originally tested with to the new org domain and tenant OU.</span>
    </P>
    <P>
        <span>Originally the vSphere and vCloud Director</span>
        <span> capabilities</span>
        <span> for automating this process</span>
        <span> are</span>
        <span> quite</span>
        <span> limited and we have found them not all that reliable.  </span>
        <span>We forced you to use only guest customization and only 3 parameters.  </span>
        <span>But</span>
        <span> now we have the VCUBE Manager Portal </span>
        <span>to help you automate this process, it goes well beyond the VMware stack to assist you in reliable clone and fix provisioning!</span>
    </P>
    <P/>
    <P>
        <span>VCUBE Portal Scripting</span>
    </P>
    <P/>
    <P>
        <span>The new VCUBE portal has the ability to define scripts per Application, per vApp, and even per VM in a vApp.  It also has the ability to link a script into either Guest Customization or Provisioning Customization.  The difference between the 2 types of customization scripts will be explained in detail in subsequent sections.  However, scripting is defined the same in either case in the portal as follows.</span>
    </P>
    <P>
        <span>Each application defines any number of scripts.  Scripts are just text strings with the exception that you can insert variable parameters into them at any point.  The portal uses the Apache Velocity </span>
        <span>template</span>
        <span> engine to allow you to use any number of different parameters in your scripting.  See </span>
        <span>http://velocity.apache.org/engine/devel/user-guide.html</span>
        <span> for more information on how Velocity works and how parameters are identified, replaced, and how escape sequences work.</span>
    </P>
    <P>
        <span>Before you define your guest customization or provisioning customization scripts for your vApp, you first define the scripts in the portal.  Scripts are defined at the application level, see below for the definition of the standard guest customization UpdateVM script:</span>
    </P>
    <P>
        <span/>
    </P>
    <P/>
    <P>
        <span>The portal supports 2 different types of </span>
        <span>parameters in your scripts:</span>
    </P>
    <P>
        <span>System Parameters</span>
    </P>
    <P>
        <span>Custom Parameters</span>
    </P>
    <P/>
    <P>
        <span>System Parameters</span>
    </P>
    <P>
        <span>The first type </span>
        <span>of scripting parameters </span>
        <span>is System Parameters.  These types of parameters are automatically resolved for you at VM provisioning time.  You do not need to enter them</span>
        <span> when you provision a module</span>
        <span>.  The portal will automatically figure them out and send them to your script</span>
        <span>s with the correct values.  </span>
        <span>The following set of system parameters are available in the current release of the portal:</span>
    </P>
    <P>
        <span>${VCM_ID}</span>
        <span> – VCUBE Manager ID hosting the VCUBE the module is provisioned into.  This parameter is very important for most vApps, it will be needed to construct names to servers like the domain controller and the Hyperic server.  Example are uspl for the Pleasanton lab and usva for the production data center in Virginia.</span>
    </P>
    <P>
        <span>$</span>
        <span>{</span>
        <span>VCM_SITE_ID</span>
        <span>}</span>
        <span> – Site ID hosting the VCUBE the VM is provisioned into</span>
    </P>
    <P>
        <span>$</span>
        <span>{</span>
        <span>VCM_VCUBE_ID</span>
        <span>}</span>
        <span> – VCUBE ID of the VCUBE the VM is provisioned into</span>
    </P>
    <P>
        <span>$</span>
        <span>{</span>
        <span>VCM_HOST_IP_ADDRESS</span>
        <span>}</span>
        <span> – IP Address of the VM</span>
    </P>
    <P>
        <span>$</span>
        <span>{</span>
        <span>VCM_HOST_NAME</span>
        <span>}</span>
        <span> – Host name of the VM (no domain name)</span>
    </P>
    <P>
        <span>$</span>
        <span>{</span>
        <span>VCM_FULLY_QUALIFIED_HOST_NAME</span>
        <span>}</span>
        <span> – Fully qualified host name of the VM</span>
    </P>
    <P>
        <span>${VCM_DOMAIN_NAME}</span>
        <span> – Domain name of the VCUBE Manager domain housing the VMware stack of servers and other VCUBE Manager servers.  Note that this may or may not be the same domain as the tenant domain below.</span>
    </P>
    <P>
        <span>${VCM_TENANT_DOMAIN_NAME}</span>
        <span> – Doma</span>
        <span>in name of the domain the tenant VMs are</span>
        <span> connected into.  This parameter is very important for most vApps as it is required to connect to the right domain, create VM host name cross-references, parameterize connections to LDAP, and so on.</span>
        <span>  Note that this may or may not be the same domain as the VCUBE Manager domain above.  In the case of data security sensitive customers, it will not.  The VCUBE Manager domain will be a global domain managing several different tenant domains so that we can pro</span>
        <span>vision tenants into separate domains with greater administrator discretion.</span>
    </P>
    <P>
        <span>$</span>
        <span>{</span>
        <span>VCM_TENANT_ID</span>
        <span>}</span>
        <span> – Tenant ID that the module is provisioned for.  This parameter is very important for most vApps, as you must rename all your VM host names to accommodate a change from the xxxeng tenant ID to the actual tenant ID the VMs are provisioned into.</span>
    </P>
    <P>
        <span>$</span>
        <span>{</span>
        <span>VCM_TENANT_OU</span>
        <span>}</span>
        <span> – Active Directory OU containing the root of the tenant For example, “OU=boa,OU=Customers” for the boa Tenant.</span>
    </P>
    <P>
        <span>$</span>
        <span>{</span>
        <span>VCM_ENVIRONMENT_ID</span>
        <span>}</span>
        <span> – Environment ID the Module is provisioned for.  For example, “d1”.  This parameter is very important for most vApps, as you must rename all your VM host names to typically switch out the environment ID.</span>
    </P>
    <P>
        <span>$</span>
        <span>{</span>
        <span>VCM_ROLE_ID</span>
        <span>}</span>
        <span> – For modules generated with Prod/Non-Prod Specific or Environment Specific role designations, this identifier will help you construct the correct set of groups to match the roles provisioned by the portal.  This value will be “prod” for Production specific modules, “nonprod” for Non-Production specific </span>
        <span>modules, or the Environment ID (for example, “d1”) for environment specific role designations.  The value is blank for desktop type vApps or server type vApps that use tenant global roles.</span>
    </P>
    <P/>
    <P>
        <span>Custom Parameters</span>
    </P>
    <P>
        <span>The portal can’t come up with every parameter you may want in your VM customization </span>
        <span>scripting </span>
        <span>sequence.  For example, if you provision Documentum, you need a Docbase ID.  That ID is specific to the environment and tenant you provision.  The VCUBE portal can’t automatically calculate it, it must be input in the user interface every time you provision a Documentum content server.  For parameters the portal can’t automatically calculate, we have Custom Parameters in the portal:</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>Just define the name of the custom parameter and any default value, and then you can insert the variable into your script just like a system variable.  Custom parameters will then be filled in when an administrator creates a vApp module for a tenant.</span>
    </P>
    <P>
        <span>Guest Customization Scripts</span>
    </P>
    <P/>
    <P>
        <span>First of all the portal automates </span>
        <span>VMware Guest Customization.</span>
        <span>  We call this the first round of provisioning customization.</span>
        <span>  This is enabled in VMware Cloud Director, for every VM, on the General and Guest OS Customization tabs.</span>
    </P>
    <P>
        <span>If you do this directly in vCloud Director,</span>
        <span> you rename name your host in the Full name and Computer name entries:</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>In the Guest OS Customization tab, you enable</span>
        <span> guest customization, change the SID, join the domain (these values are all pre-filled for you by the OnDemand team), and… </span>
    </P>
    <P/>
    <P/>
    <P>
        <span/>
        <span/>
    </P>
    <P>
        <span>…enable a guest customization script:</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>The script after that is entirely up to you.  We used to enforce the following script but now we are flexible per vApp (and actually even per VM within a vApp) and this script can be parameterized in the VCUBE portal.  The script we recommend follows:</span>
    </P>
    <P>
        <span>Powershell.exe -ExecutionPolicy unrestricted c:\OnDemandScripts\CustomizeVM\UpdateVM.ps1 </span>
        <span>t1 cust01 iigcf</span>
        <span>-eu</span>
        <span>.com</span>
        <span/>
        <span>uspl</span>
        <span/>
        <span>iigcf.com</span>
        <span/>
        <span>&gt;&gt; c:\OnDemandScripts\guestCustomization.log 2&gt;&amp;1 </span>
        <span>_xPresso_</span>
    </P>
    <P>
        <span>T</span>
        <span>he parameters in red</span>
        <span/>
        <span>in this example are:</span>
    </P>
    <P>
        <span>t1</span>
        <span> – The 2 character environment ID</span>
        <span>.  This parameter is named </span>
        <span>${VCM_ENVIRONMENT_ID} </span>
        <span>in the VCUBE Manager Portal.</span>
    </P>
    <P>
        <span>cust01 </span>
        <span>– The </span>
        <span>tenant</span>
        <span/>
        <span>ID</span>
        <span> (up to 6 characters)</span>
        <span>.</span>
        <span/>
        <span>This parameter is named </span>
        <span>${VCM_TENANT_ID}</span>
        <span> in the VCUBE Manager Portal</span>
    </P>
    <P>
        <span>iigcf</span>
        <span>-eu</span>
        <span>.com</span>
        <span> – The windows domain name</span>
        <span> that the VM is attached to</span>
        <span>.  This parameter is named</span>
        <span> ${VCM_</span>
        <span>TENANT_</span>
        <span>DOMAIN_NAME} </span>
        <span>in the VCUBE Manager Portal.</span>
        <span/>
        <span> Note that this domain </span>
        <span>may</span>
        <span> be different than the VCUBE Manager domain as a single VCUBE Manager domain may manage several different tenant domains.</span>
    </P>
    <P>
        <span>uspl</span>
        <span> – The VCUBE Manager </span>
        <span>ID</span>
        <span>, which is used to construct host names to things like the domain controller (uspl-dc01.iigcf.com in this example) or the Hyperic server (uspl-hyperic01.iigcf.com in this example)</span>
        <span>.  This parameter is named</span>
        <span> ${VCM_ID}</span>
        <span> in the VCUBE Manager Portal.</span>
    </P>
    <P>
        <span>iigcf.com</span>
        <span> – The domain name for the VCUBE Manager.  This parameter is named ${VCM_</span>
        <span>DOMAIN_NAME} </span>
        <span>in the VCUBE Manager Portal.</span>
        <span/>
        <span> Note that this domain </span>
        <span>may</span>
        <span> be different than the tenant domain above as a single VCUBE Manager domain may manage several different tenant domains.</span>
    </P>
    <P/>
    <P>
        <span>If you set up this script in the VCUBE Manager portal, it will look </span>
        <span>something </span>
        <span>like this:</span>
    </P>
    <P>
        <span/>
    </P>
    <P/>
    <P>
        <span>However, as long as you properly define and test the script in the VCUBE portal and properly document how </span>
        <span>to </span>
        <span>do so in your vApp provisioning guide, you are now free to change the parameters as you see fit!</span>
    </P>
    <P>
        <span>Also note also that even though a desktop does </span>
        <span>not</span>
        <span> have an environment, the </span>
        <span>environment parameter is still </span>
        <span>very valuable</span>
        <span> for desktop provisioning</span>
        <span>!  The environment parameter is not the desktop pool ID, it is the default server </span>
        <span>environment that the desktop should connect its thick and thin clients to.  We do this to make it easier for the user.  We do not want every desktop user to have to remember what server to connect to.  So we give the environment parameter to the desktop so that the desktop can auto-configure all the clients to connect by default to the best server environment, which is usually the “d1” server environment as most desktop clients are used for development.  However, if you provision a production end user desktop like a Captiva scan client environment, the default should be “p1” of course so that it connects by default to the production </span>
        <span>environment</span>
        <span>.</span>
    </P>
    <P>
        <span>We decided upon Windows PowerShell as the script language of choice as it is very powerful and does an extremely good job of identifying and logging errors.  So you must use PowerShell for guest customization but you are allowed to call other scripting technologies (cmd /c mybat.bat) as well.  However beware that other scripting technologies often ignore or obfuscate errors so debugging them is very challenging.</span>
    </P>
    <P>
        <span>The PowerShell script </span>
        <span>must</span>
        <span> be located at:</span>
    </P>
    <P>
        <span>c:\OnDemandScripts\CustomizeVM\UpdateVM.ps1</span>
    </P>
    <P>
        <span>The OnDemand team has several scripts to get you started and examples of how to easily find/replace strings in files, update registry settings, and call other scripts.</span>
    </P>
    <P>
        <span>Next, </span>
        <span>for any provisioning script </span>
        <span>you must make sure it is safe to run this more than one time in suc</span>
        <span>cession.  VMware always runs guest customization</span>
        <span> script</span>
        <span>s</span>
        <span> 2 times (and OnDemand administrators will run it manually when things fail), so it </span>
        <span>must be safe</span>
        <span> to execute multiple times in a row.</span>
    </P>
    <P>
        <span>Finally, you </span>
        <span>must</span>
        <span> provide an undo script so that we can easily test and revert any/all changes before checking the template into the catalog.  The undo script </span>
        <span>must</span>
        <span> be located at:</span>
    </P>
    <P>
        <span>c:\OnDemandScripts\CustomizeVM\</span>
        <span>undo</span>
        <span>UpdateVM.ps1</span>
    </P>
    <P>
        <span>The undo script</span>
        <span> again</span>
        <span/>
        <span>must be safe</span>
        <span> to be executed multiple times in succession.</span>
    </P>
    <P/>
    <P>
        <span>How </span>
        <span>Guest Customization</span>
        <span> Works</span>
    </P>
    <P>
        <span>When a VM built in this manner is checked out of the catalog, and had the computer name and guest customization parameters set accordingly, VMware Cloud director will then run Microsoft Windows sysprep when every VM is booted for the first time.  This is done for you automatically, so your job is to make sure you rename the computer name and parameterize the guest customization script (only the 3 parameters!) correctly and that is it.  You can verify your customization script is executed by looking at the log file </span>
        <span>c:\OnDemandScripts\guestCustomization.log</span>
        <span>.  Hopefully you used PowerShell AND you wrote out a lot of debug statements so you can verify things went right or wrong.  The scripts are headless, there is no user to notify when things go wrong</span>
        <span> and no opportunity to ask a user for input of any kind</span>
        <span>.  So if you don’t log output to stdout or stderr, good luck debu</span>
        <span>gging the customization process.</span>
    </P>
    <P>
        <span>The next thing to know is that these scripts are run during sysprep, </span>
        <span>before</span>
        <span> you have network connectivity and </span>
        <span>before</span>
        <span> any services are started.  So these scripts have a lot of limitations, they cannot connect to a database and run SQL scripts, they can’t call a web service, and so on.  They can basically only modify files and registry </span>
        <span>settings.  If your application needs to do more than that, </span>
        <span>see the next section below for Provisioning Customization type scripts.</span>
    </P>
    <P>
        <span>Lots of things can go wrong with sysprep, so it is very useful to know where to look when things don’t run as planned (computer name doesn’t get renamed, IP address isn’t correct, computer didn’t join the domain, …).  See </span>
        <span>http://msdn.microsoft.com/en-us/library/ff794631(v=winembedded.1001).aspx</span>
        <span> for information and check out the log and error files in the following directories:</span>
    </P>
    <P/>
    <Table>
        <Tr>
            <Td>
                <P>
                    <span>Sysprep Phase</span>
                    <span/>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Log Path </span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>G</span>
                    <span>eneralize</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>C:\Windows</span>
                    <span>\System32\Sysprep\Panther</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>S</span>
                    <span>pecialize</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>C:\Windows</span>
                    <span>\Panther\</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>unattended actions</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>C:\Windows</span>
                    <span>\Panther\Unattendgc</span>
                </P>
            </Td>
        </Tr>
    </Table>
    <P/>
    <P/>
    <P/>
    <P>
        <span>Provisioning Customization</span>
    </P>
    <P/>
    <P>
        <span>Before the VCUBE Manager portal, we were just stuck with VMware guest customization per above.  Guest customization is not fun, for a Windows</span>
        <span> VM it requires Windows sysprep;</span>
        <span> that process is notoriously brittl</span>
        <span>e;</span>
        <span> and VMs frequently don’t join the domain automatically as they should.  Rearm counts and licensing and all kinds of issues arise.  Then after you go through all of that just to get a VM running properly on the network, then you have to run all kinds of manual scripts to finish the “fix” part of “clone and fix”.  The second set of scripts require you to log in to the VMs with the correct account, get exactly the right set of parameters into the scripts, run the scripts, watch for errors, and fix anything that doesn’t work.</span>
    </P>
    <P/>
    <P>
        <span>Fortunately we believe the portal will solve a lot of these problems.  First of all, after the guest customization process above, the portal checks to see if the VM has come up on the network and joined the domain.  If it doesn’t, it tries to correct the issue on its own.</span>
        <span>  Typically it will be able to with a command sequence and a VM reboot.  So if you use the portal, this is done for you.  If you don’t use the portal and just do this through vCloud Director, well shame on you, you have more work to do!</span>
    </P>
    <P/>
    <P>
        <span>Next, the portal allows you to run any number of scripts with any number of parameters in any sequence</span>
        <span> (cool huh!)</span>
        <span>.  You define them per VM in your vApp</span>
        <span> module template</span>
        <span> an</span>
        <span>d the portal will run them!  However,</span>
        <span> you must remember the rules when you define these scripts:</span>
    </P>
    <P/>
    <P>
        <span>Provisioning customization scripts are not run until the guest customization process has completed for all VMs in the vApp.  Also these scripts are not run until all VMs in your vApp have come up on the network, and all VMs have joined the domain.  If any VM in your vApp has not met this criteria, the provisioning customization is on hold until it does so.</span>
    </P>
    <P/>
    <P>
        <span>Provisioning customization scripts are run under a domain system account with domain administrator credentials (that is, a very powerful account, take great care!).  All scripts across all VMs are run under the same account, the portal cannot pick and choose accounts today.</span>
    </P>
    <P/>
    <P>
        <span>Scripts are executed in the order of the step number</span>
        <span> you define when setting up the script in the portal.  The step number is taken into consideration across the entire vApp.  For example, if you define script step 1 on the database server and script step 1 on the app server, those scripts can be executed in any order or in parallel</span>
        <span>, at the discretion of the portal</span>
        <span>.  If you need them to be executed in sequence, for example, the database script must be executed first, then the app server script, you must increase the step number</span>
        <span> between the scripts</span>
        <span>.  The database script must be step 1 and the app server script must be step 2.</span>
        <span>  Step 2 scripts are never executed until step 1 scripts are fully executed across the entire vApp and the scripts are successful.</span>
    </P>
    <P/>
    <P>
        <span>Scripts must return an exit</span>
        <span> code!  We use scrip</span>
        <span>ting best practices here.  Exit</span>
        <span> code 0 is a successful script.  A non-zero e</span>
        <span>xit</span>
        <span> code is an unsuccessful script.  If your scri</span>
        <span>pt returns an unsuccessful exit</span>
        <span> code, the provisioning process is forever halted until the VM is fixed so that your script upon </span>
        <span>restart will return a zero exit</span>
        <span> code.  So your </span>
        <span>exit</span>
        <span> code handling must be r</span>
        <span>ock solid.</span>
    </P>
    <P/>
    <P>
        <span>Provisioning customization scripts can have a designation where you reboot the VM after the script has succeeded (returned a zero exit code).  In this case, all provisioning scripts with a higher number than the current script are halted until the VM has rebooted and is available on the network.</span>
    </P>
    <P/>
    <P>
        <span>Scripts can be</span>
        <span> run multiple times </span>
        <span>in situations where scripts return an </span>
        <span>exit</span>
        <span> code.  Every action of every script must be safe and effective to run multiple times.  When executed subsequent times, it must return a zero error code to denote that all actions the script was supposed to execute did indeed execute properly, and of course a non-zero error code if your script did not fully execute everything it intends to execute.</span>
    </P>
    <P/>
    <P>
        <span>If your scripts cannot conform to these rules, then you will need to </span>
        <span>leave them to be manual steps to be executed, but of course the OnDemand team will not like this, so please try your best to automate everything involved in the deployment of your application.</span>
        <span>  Provisioning scripts are defined in the portal in the module template, VM Clusters tab (a VM Cluster is just a VM in your vApp) as follows:</span>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>Putting it All Together</span>
    </P>
    <P>
        <span>Let’s go through the process above step by step so you can put all the standards information above together for an example of a simple 3 tier application (database, app server, web server) with a managed desktop (having both thin and thick clients).  Let’s assume we have a product named </span>
        <span>“</span>
        <span>Hlp</span>
        <span>”</span>
        <span>.  That product prefix you register with OnDemand is “hlp”</span>
        <span>.  The steps to creating an OnDemand vApp follow</span>
        <span>:</span>
    </P>
    <P>
        <span>Step 1: Create simple 3-tier Server vApp</span>
    </P>
    <P>
        <span>Step 2: Add Shared directory and local “hlp” administrator group, map to domain “hlp” administrator group</span>
    </P>
    <P>
        <span>Step 3: Create desktop vApp</span>
    </P>
    <P>
        <span>Step 4: Install, Lock Down, and Test Software</span>
    </P>
    <P>
        <span>Step 5: Guest Customize Software for VCUBE Deployment</span>
    </P>
    <P>
        <span>In Step 1, the OnDemand team creates an hlpeng org for you.  You create a server vApp</span>
        <span> with a database VM and app server VM</span>
        <span> per information </span>
        <span>in a previous section</span>
        <span> and name it as follows:</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>Next in Step 2, you add at least one group for role-based access controls for your application.  You will need at least an administrator group (to view log files), more depending upon how your application works.  The OnDemand team will add the group to the OnDemand active directory server (and promote it to the different </span>
        <span>domains).  You will then add a local group to your VMs and make the domain group a member (as described in an early section of this document).  You secure your shared files using that group (and any others you require) as well as everything on the desktop.  You don’t need to secure files outside of the shared directory on a server as everything else is locked down by default.  But you do need to take </span>
        <span>great</span>
        <span> care</span>
        <span> for every file on the desktop as end users will log into the desktop and have access to everything unless you lock it down!  See below for a diagram of this step.</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>In step 3, you add the managed desktop vApp and VM, connect it to the managed server by naming conventions established in the previous sections, and secure it with the groups you created in step 2.</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>In Step 4 you install all the software for both the managed server and the managed desktop.  Remember to install everything best practice, unparalleled in any install throughout the world.  Minimize any issues a </span>
        <span>tenant</span>
        <span> could have, think about how most </span>
        <span>tenant</span>
        <span>s would want the software configured, and make that the default.  Note that best practice is rarely how the software is installed by default!</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>Finally, in step 5, you apply all the guest customizations as discussed in the previous </span>
        <span>section.</span>
        <span>  The guest customizations must not only work in the lab domain but must also work when the vApps are deployed in other domains.  This is relatively simple if you make sure all permissions are group based, the groups are always local to the VMs, and the local groups have a member of the domain group.  The OnDemand team has a script you can modify to switch out the group membership between domains.</span>
    </P>
    <P>
        <span/>
        <span/>
    </P>
    <P>
        <span>The diagram above shows how, when all the standards are followed, a vApp designed for a lab domain can be provisioned for a production domain and all the groups and users still function properly to secure the application.</span>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>Software Provisioning and Support Manual Guide</span>
    </P>
    <P/>
    <P>
        <span>Every vApp added to the OnDemand catalog must have a manual written to our specifications so that the OnDemand team can certify the application and support it in production.  We call this manual the </span>
        <span>EMC </span>
        <span>OnDemand Software Provisioning and Support Manual.</span>
        <span>  This manual describes:</span>
    </P>
    <P>
        <span>The blueprint of the vApp.  The name and purpose of each VM in the vApp, start and stop order dependencies, products and versions installed, and ports upon which they are installed and required to be open to communicate inside the vApp, between vApps in the VCUBE, and outside the VCUBE.</span>
        <span>  Information on how to load balance the vApp and how to scale it vertically and horizontally.</span>
    </P>
    <P>
        <span>For each VM:</span>
    </P>
    <P>
        <span>Product D</span>
        <span>etails</span>
        <span> of what is installed, where it is installed, what services invoke what products, </span>
        <span>service dependencies, </span>
        <span>what accounts were used to install the product, what accounts are used to run the products if they differ from the accounts that installed them, and what licenses are used to run them.  </span>
    </P>
    <P>
        <span>Provisioning/Renaming Details</span>
        <span> of</span>
        <span> provisioning/renami</span>
        <span>ng scripts</span>
        <span>, what changes</span>
        <span> in the VM</span>
        <span> they affect, and how to verify the changes</span>
        <span>, how to manually make the updates should the scripts fail to execute properly</span>
        <span>, and how to license it with license keys appropriate to what the </span>
        <span>tenant</span>
        <span> paid for from the EMC licensing team.</span>
    </P>
    <P>
        <span>Sanity Test</span>
        <span> scripts of how to manually test the provisioned system and integrated systems like Documentum to verify the vApp is working properly after it is provisioned</span>
    </P>
    <P>
        <span>Patching and Upgrade</span>
        <span> note</span>
        <span>s for the application team to properly patch and upgrade the system after it is provisioned</span>
    </P>
    <P>
        <span>Anythin</span>
        <span>g else you think would be valuable to the OnDemand and support teams to provide the best overall experience for the </span>
        <span>tenant</span>
    </P>
    <P/>
    <P>
        <span>T</span>
        <span>he latest template version of this required document</span>
        <span> is located in the OnDemand vApp developers CenterStage space</span>
        <span>.</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>vApp Construction Checklist</span>
    </P>
    <P/>
    <P>
        <span>Have you started with server or desktop VMs prepared for you by the OnDemand team?</span>
        <span>  If not, stop immediately, we cannot take an outside VM into our environment.</span>
    </P>
    <P/>
    <P>
        <span>Are all your server and desktop VMs fully licensed</span>
        <span>, Datacenter Edition (not Standard Edition) and have a rearm count of 1</span>
        <span>?  Do </span>
        <span>NOT work with any other VM as they</span>
        <span> will not p</span>
        <span>rovision </span>
        <span>easily into lab and production environments</span>
        <span>.  Do NOT add</span>
        <span> such a VM into the Cloud Director catalog.</span>
    </P>
    <P/>
    <P>
        <span>Did you name all your server and desktop VMs correctly?  Incorrectly named VMs cannot be provisioned.</span>
    </P>
    <P/>
    <P>
        <span>Did you construct your vApp correctly?  For server vApps, you will need all servers required to make a self-sufficient execution environment of your software in the same vApp.  You are not allowed to share VMs across </span>
        <span>tenant</span>
        <span>s or environments.  For desktop vApps, you may only have one VM in the vApp.  That VM will be cloned to form a pool of identical VMs at provisioning time.</span>
    </P>
    <P/>
    <P>
        <span>Are all products you installed into the VMs licensed properly?  OnDemand will take responsibility for licensing the software provided in the templates only.  Anything product teams install are the responsibility for those teams to license properly and must document how to obtain and update any required license keys after the environments are provisioned by a </span>
        <span>tenant</span>
        <span>.</span>
    </P>
    <P/>
    <P>
        <span>Are all directories and files containing any </span>
        <span>tenant</span>
        <span> data stored on the D: drive and any ACLs required to lock them down restored during guest customization?</span>
    </P>
    <P/>
    <P>
        <span>Are all products you installed into the VMs licensed properly?  OnDemand will take responsibility for licensing the software provided in the templates only.  Anything product teams install are the responsibility for those teams to license properly and must document how to obtain and update any required license keys after the environments are provisioned by a </span>
        <span>tenant</span>
        <span>.</span>
    </P>
    <P/>
    <P>
        <span>Are all server products installed registered as Windows Services and set to automatically start when the operating system boots?</span>
        <span>  Windows Service</span>
        <span> names should clearly reflect the nature of the component they run.</span>
    </P>
    <P/>
    <P>
        <span>Are all desktop products installed in such a fashion that normal users can run them?  Users will not be permitted to log in as desktop administrators.</span>
        <span>  Any user with permission to log into a pooled desktop so you must place any desktop items in the c:\Users\Public\Desktop folder</span>
    </P>
    <P/>
    <P>
        <span>Are the VMs properly integrated with the OnDemand identity management system?  You must support at a minimum user types #1 (which is largely done for you by the operating system templates) and user type #2 (which is your responsibility as an application provider).  For all user types, you are not allowed to use specific user IDs, only user groups in authorization lists and ACLs.</span>
    </P>
    <P/>
    <P>
        <span>Have you provided D</span>
        <span>:\Shared\&lt;product name&gt; directories with Windows file share and FTP access, locked down with appropriate ACLs by user groups you defined in the OnDemand identity management system?</span>
    </P>
    <P/>
    <P>
        <span>Have you properly tested guest customization?  You must provide 2 scripts:</span>
    </P>
    <P/>
    <P>
        <span>c:\OnDemandScripts\CustomizeVM\UpdateVM.ps1</span>
    </P>
    <P>
        <span>c:\OnDemandScripts\CustomizeVM\</span>
        <span>undo</span>
        <span>UpdateVM.ps1</span>
    </P>
    <P/>
    <P>
        <span>The UpdateVM script must morph the VM template into a properly provisioned environment for a </span>
        <span>tenant</span>
        <span>.  It must be safe to run multiple times (VMware always runs it at least 2 times per VM).  The undoUpdateVM must undo every change made by the UpdateVM script so that the template can be tested and reverted before being checked into the catalog.  This script must as well be safe to be run multiple times.</span>
    </P>
    <P/>
    <P>
        <span>Have you tested your server vApp in a </span>
        <span>tenant</span>
        <span> org?  The server vApp must properly morph the VM host names per above, must properly connect to other integrated systems in the VCUBE (for example, xPression and Captiva must properly connect to a Documentum instance of the same environment name if it is present), and must switch the OU filter to only allow users for that Customer OU in the OnDemand LDAP tree.</span>
    </P>
    <P/>
    <P>
        <span>Have you tested your desktop vApp in a </span>
        <span>tenant</span>
        <span> org through VMware View?  All software must run properly as a normal user inside the Customer OU, and all desktop icons must be present in the all users desktop area.  Running your software as a desktop administrator or a domain administrator </span>
        <span>in VMware View </span>
        <span>is not a good test of your so</span>
        <span>ftware, </span>
        <span>tenant</span>
        <span>s will not have those permissions.</span>
    </P>
    <P/>
    <P>
        <span>Have you tested your VMs the same way our OnDemand administrators and our </span>
        <span>tenant</span>
        <span>s will run them?  Managed Servers cannot be logged into with local admin accounts.  You must use a domain administrator account and that account must have permissions to do as required to administer the application.  Managed Desktops cannot be logged into with administrator rights.  The only acceptable end users logins to managed desktops are domain users without administrator rights.</span>
    </P>
    <P/>
    <P>
        <span>Are your VMs clean of crud?  Don’t leave old installation files and backups around in a VM template.  That wastes disk space and backup space.  Only leave files on the file system required to run the software.  These templates need to be the gold standard.  Imagine that we will make 1,000 clones of these templates as our </span>
        <span>tenant</span>
        <span>s run the software you built.  If you leave crud around, we just may punish you by making you log into all 1,000 of those VMs and clean it up yourself.  So provide a nice clean VM!</span>
    </P>
    <P/>
    <P>
        <span>If you added a D: drive or any other type of drive to your VM, is it an MBR type disk partition?  GPT type partitions are not supported in EMC OnDemand, they do not work well enough with EMC backup technology.</span>
    </P>
    <P/>
    <P>
        <span>Are your VMs upgraded per instructions in the following section?</span>
    </P>
    <P/>
    <P/>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>VM Upgrade Instructions</span>
    </P>
    <P/>
    <P>
        <span>The OnDemand team has been upgrading VM templates </span>
        <span>in the </span>
        <span>admin catalog</span>
        <span> to make it easier for new applications to be constructed in OnDemand and also to make it easier to provision and support these VMs in production.  This section will contain a change log of all the improvements so you can upgrade your VMs without starting from scratch with a new base VM template.</span>
    </P>
    <P>
        <span>Upgrade Windows Server Operating System to Datacenter Edition</span>
    </P>
    <P/>
    <P>
        <span>This upgrade is very important to OnDe</span>
        <span>mand as it solves 3</span>
        <span> significant issues:</span>
    </P>
    <P>
        <span>Uses a license key server to automatically license operating systems in our lab environments and data centers.  We had to manually license the operating systems when using Windows Server Standard Edition.</span>
    </P>
    <P>
        <span>Support </span>
        <span>hot add vCPU and memory.  Easily support more than 8 vCPUs per VM.  The VMware virtual infrastructure works much better with this operating system version.</span>
    </P>
    <P>
        <span>The operating system rearm count does not need to be reset.  This was a very painful (and unsupported) process that the OnDemand team needed to do on your behalf before you cataloged any of your VMs.</span>
    </P>
    <P/>
    <P>
        <span>Step 1: Take an existing guest OS from Standard Edition to DataCenter Edition</span>
    </P>
    <P/>
    <P>
        <span>Open a command prompt at an elevated command level</span>
    </P>
    <P>
        <span>Windows &gt; Right-click on Command prompt and ‘Run as Administrator’</span>
    </P>
    <P>
        <span>Run the DISM command to set the edition to DataCenter</span>
    </P>
    <P>
        <span>DISM /online /Set-Edition:ServerDatacenter /productkey:74YFP-3QFB3-KQT8W-PMXWJ-7M648</span>
    </P>
    <P>
        <span>The system will prompt for a reboot, confirm the reboot with “Y” (screenshot below)</span>
    </P>
    <P/>
    <P>
        <span>Step 2: Validate that the guest OS is at the DataCenter edition</span>
    </P>
    <P/>
    <P>
        <span>Open a command prompt at an elevated command level</span>
    </P>
    <P>
        <span>Windows &gt; Right-click on Command prompt and ‘Run as Administrator’</span>
    </P>
    <P>
        <span>Run the DISM command to check the edition</span>
    </P>
    <P>
        <span>DISM /online /get-currentedition</span>
    </P>
    <P/>
    <P>
        <span>Run slmgr.vbs to check the KMS host and client information</span>
    </P>
    <P>
        <span>slmgr /dlv</span>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P/>
    <P>
        <span>Note that the rearm count is set to 1.  This is ok.  You may be used to seeing this at 4 or 5.  But the good news is that it never decrements when using Datacenter edition, so a rearm count of 1 is just fine now.</span>
    </P>
    <P>
        <span>Removal of the Old Virus Scanner</span>
        <span> and VCM Package Manager</span>
    </P>
    <P/>
    <P>
        <span>Hopefully these programs are not installed in your VMs.  They are not part of recent VM templates, but you may have started from a very old template.  In any case, these programs cannot be in your VMs as they will conflict with other software.</span>
    </P>
    <P/>
    <P>
        <span>Uninstall  VMware VCM Package Manager for Windows, McAfee Agent, McAfee VirusScan Enterprise, and McAfee AntiSpyware Enterprise Module (these programs may or may not exist)</span>
    </P>
    <P>
        <span>Start – Control Panel – Uninstall a program (if you see McAfee Agent or McAfee AntiSpyware Enterprise Module go to step b if not go to step e)</span>
    </P>
    <P>
        <span>If the McAfee Agent or McAfee AntiSpyware Enterprise Module exist – go to start – run – cmd – type cd “C:\Program Files (x86)\McAfee\Common Framework” – type:</span>
    </P>
    <P>
        <span>cd “C:\Program Files (x86)\McAfee\Common Framework”</span>
    </P>
    <P>
        <span/>
        <span/>
        <span>FrmInst.exe /Remove=Agent</span>
    </P>
    <P>
        <span>Reboot the VM  </span>
    </P>
    <P>
        <span>login</span>
    </P>
    <P>
        <span>Start – Control Panel – Uninstall a program</span>
    </P>
    <P>
        <span>Remove any programs listed above</span>
    </P>
    <P>
        <span>Reboot</span>
    </P>
    <P>
        <span>go to start – run – cmd – type (yes, again, if the directory still exists): </span>
    </P>
    <P>
        <span>cd “C:\Program Files (x86)\McAfee\Common Framework”</span>
    </P>
    <P>
        <span>FrmInst.exe /Remove=Agent</span>
    </P>
    <P>
        <span>Start – Control Panel – Uninstall a program (make sure the programs listed above do not exist)</span>
    </P>
    <P/>
    <P>
        <span>Add 7-zip, </span>
        <span>WinMerge, and Notepad++</span>
    </P>
    <P/>
    <P>
        <span>All 3 of these programs are free for commercial use and can help EMC OnDemand administrators when working with your VMs.  </span>
        <span>Contact the OnDemand team for which versions to install.</span>
    </P>
    <P/>
    <P>
        <span>Update VM Video RAM to 32 MB</span>
    </P>
    <P/>
    <P>
        <span>The default Video RAM is pretty small</span>
        <span>, sometimes as small as 8 MB</span>
        <span>.  If </span>
        <span>you log into a VM with a high resolution desktop you could easily exceed the amount of video memory and crash the VM, simply by logging into the VM you would cause a blue screen and a customer outage.  So it is very important to update your Video RAM on every VM.  Unfortunately this setting is hidden away in vCenter/vSphere and not exposed in vCloud Director, so you may need to get the OnDemand team to view and confirm your setting is correct:</span>
    </P>
    <P>
        <span/>
    </P>
    <P/>
    <P>
        <span>Update to VMware Virtual Machine 8 and VMware Tools</span>
        <span> with vShield Driver</span>
    </P>
    <P/>
    <P>
        <span>vCloud Director, vSphere, and the EMC OnDemand portal all perform automated provisioning actions.  Those actions will not run properly or fully with older levels of virtual machines or VMware Tools.  Make sure you are running </span>
        <span>VMware hardware </span>
        <span>version 8 (shown below in a v</span>
        <span>Cloud Director</span>
        <span> screen capture</span>
        <span> of VMs in a cataloged vApp</span>
        <span>)</span>
        <span>:</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>VMware tools running inside the VM should </span>
        <span>be updated to </span>
        <span>match the hardware version of the virtual</span>
        <span> machine you are running</span>
        <span> and should include the vShield Driver required for Trend Deep Security virus scanning</span>
        <span>.  If any questions on upgrading your VM</span>
        <span> per instructions below</span>
        <span>, please rea</span>
        <span>ch out to the EMC OnDemand team:</span>
    </P>
    <P>
        <span>Right click VM in Virtual Center –&gt; guest –&gt; install VMware Tools –&gt; interactive  tools upgrade</span>
    </P>
    <P>
        <span>Run 64bit setup64.exe from CD rom drive on VM, clicking on:</span>
    </P>
    <P>
        <span> –&gt; next –&gt; modify –&gt; expand VMware device drivers –&gt; expand VMCI Drivers –&gt; make sure vShield Drivers check box is checked –&gt; next –&gt; install.</span>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>Use VMware Optimized LAN Adapter</span>
    </P>
    <P/>
    <P>
        <span>Login to</span>
        <span> image and run ipconfig.</span>
    </P>
    <P>
        <span>R</span>
        <span>ecord </span>
        <span>the IP</span>
        <span> address, default Gateway, DNS servers and subnet mask</span>
        <span>.</span>
    </P>
    <P>
        <span>L</span>
        <span>ogin </span>
        <span>into v</span>
        <span>C</span>
        <span>loud</span>
        <span>D</span>
        <span>irector, find the VM, and shut it down.  Edit its properties,</span>
        <span> click hardware tab – uncheck the C</span>
        <span>onnected box, check the Show network adapter type checkbox,</span>
        <span> click the add button</span>
        <span> ion the NICs section.</span>
        <span/>
        <span>S</span>
        <span>elect primary nic – select VMX</span>
        <span>NET </span>
        <span>3 (make sure show network adaptor type is checked</span>
        <span> or you won’t see and be able to switch this</span>
        <span>)</span>
        <span>.  S</span>
        <span>witch </span>
        <span>IP</span>
        <span/>
        <span>Mode</span>
        <span> to static manual</span>
        <span>.  T</span>
        <span>ype in noted ip address</span>
        <span>.  It should look something like this:</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>C</span>
        <span>lick the delete</span>
        <span> button next to the original NIC.</span>
        <span/>
        <span>Switch tabs to the</span>
        <span> Guest Customizatio</span>
        <span>n tab and</span>
        <span> check Enable guest customization</span>
        <span>.</span>
        <span/>
        <span/>
        <span>Uncheck Change SID</span>
        <span>,</span>
        <span> unch</span>
        <span>eck this </span>
        <span>VM</span>
        <span> to join the domain, and</span>
        <span> remove scripts in scripts field. </span>
        <span> We need to run guest customization to switch the NIC but we don’t want to change its SID, domain, or run any guest customization scr</span>
        <span>ipts, just switch the NIC only</span>
        <span>!  </span>
        <span>It is </span>
        <span>very </span>
        <span>important to uncheck the Change SID check box. Failure to do so will cause the image to break.  Click ok</span>
        <span>, then right click on the VM, select “Power On and Force Recustomization”.</span>
    </P>
    <P/>
    <P/>
    <P>
        <span>Turn off IE ESC and UAC</span>
    </P>
    <P/>
    <P>
        <span>Internet Explorer Enhanced Security Configuration and the Windows User Account Control put in place security controls that in general do not increase our security posture as a cloud service provider but instead make it more difficult to provide the offering.  IE ESC will make it difficult for administrators to sanity test and debug the software and make it difficult or impossible for end users to use managed desktops properly.  Windows UAC will make it impossible to provision VMs automatically and will cause administrator and end user issues as well.</span>
    </P>
    <P>
        <span>To disable IE ESC, go to Control Panel, Server Manager, and click on the Configure IE ESC link.  Turn it off for both Administrators and Users:</span>
    </P>
    <P>
        <span/>
    </P>
    <P/>
    <P>
        <span/>
    </P>
    <P>
        <span>To disable UAC, go to the Control Panel, User Accounts, User Accounts (again), and </span>
        <span>click on Change User Account Control settings.  Switch to the lowest level, Never notify:</span>
    </P>
    <P>
        <span/>
    </P>
    <P/>
    <P>
        <span>Add a High Speed D: Drive for Optimized Sensitive Data Encryption</span>
    </P>
    <P/>
    <P>
        <span>Make sure the VM is stopped. </span>
    </P>
    <P>
        <span>Go to VM properties in vCloud Director and switch to Hardware Tab</span>
    </P>
    <P>
        <span>Add disk and select size to be 4 GB by default, Bus Type as ‘Paravirtual (SCSI)’:</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>Click OK and start the VM</span>
    </P>
    <P>
        <span>Once the VM is started go to Server Manager &gt; Storage &gt; Disk management. </span>
    </P>
    <P>
        <span>Change CD drive to E</span>
    </P>
    <P>
        <span>Configure the New Drive and select D as drive letter. </span>
    </P>
    <P>
        <span>Name it appropriately.</span>
    </P>
    <P>
        <span/>
    </P>
    <P>
        <span>Change Control Log</span>
    </P>
    <P/>
    <Table>
        <Tr>
            <Td>
                <P>
                    <span>Date</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Version</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Made by</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Description</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>5/3</span>
                    <span>/11</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>0.1</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Initial draft</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>5/5</span>
                    <span>/11</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>0.2</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Added identity management section, licensing section, and checklist</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>5/23/11</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>0.3</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Updated identity management section (significant updates to LDAP OU structure), added more information on lab and Rackspace environments.</span>
                    <span/>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>5/25/11</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>0.4</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Added information on securing VMs.</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>6/15/11</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>1.0</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Updated to rework the environment to support early adopter and controlled release, plus parallel engineering/support tasks.</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>6/23/11</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>1.1</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Added a section on provisioning vApps and VMs for engineering application builds.  Clarified the section on validating the rearm count.</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>10/28</span>
                    <span>/11</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>1.2</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Clarified language in the OnDemand overview.  Removed Controlled Release as we are moving on to GA.</span>
                </P>
                <P>
                    <span>Added a hardware and virtual software stack specification in section 2.</span>
                </P>
                <P>
                    <span>Corrected issues </span>
                    <span>with naming conventions.</span>
                    <span>  Specifically, we had problems naming the desktops, added an “</span>
                    <span>r</span>
                    <span>” designation in to all the managed desktops so it is clearly separated from server types. </span>
                </P>
                <P>
                    <span>In section 6.2, went into detail about custom groups, their types, and their naming conventions.  Also established naming conventions for </span>
                    <span>View pool gr</span>
                    <span>o</span>
                    <span>ups.</span>
                </P>
                <P>
                    <span>Added section 8 to describe how everything comes together to get a production quality locked down application.</span>
                </P>
                <P>
                    <span>Added </span>
                    <span>a VM upgrade section</span>
                    <span> 11</span>
                    <span> to list all the instructions and steps to upgrade your VMs to keep pace with EMC OnDemand improvements.</span>
                    <span>  Details to come…</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>1</span>
                    <span>/</span>
                    <span>23</span>
                    <span>/12</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>1.3</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Added a new section 7 to discuss where </span>
                    <span>to store customer data so that it is done in a best practice manner and also that we can easily optionally encrypt all customer data-at-rest.</span>
                </P>
                <P>
                    <span>Removed OU=Computers inside the Customer OU, it did not help us implement customer specific Windows policies.</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>3/23</span>
                    <span>/12</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>1.4</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Changed desktop naming conventions again (so sorry) and the DesktopPool naming convention in Active Directory so that our provisioning system could automate delivery and management of desktop pools.</span>
                </P>
                <P>
                    <span>Added some clarification to our policy on D: drives (and encryption).</span>
                </P>
                <P>
                    <span>Clarified language for desktop environment provisioning parameters.  Environment is still a required and important parameter for desktop provisioning.</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>5/30/12</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>1.5</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Added EPFM and D2 product prefixes.  Fixed the OU name for the Employees\EMC Admin OU.</span>
                </P>
                <P>
                    <span>Changed terminology to reflect a host of enhancements in the VCUBE technology.  Added a new section on VCUBE terminology.  The most important changes are that we are changing the name from “customer” to “tenant.”  Second, we are splitting VCUBE and customer/tenant so that a customer/tenant can have multiple VCUBEs.  The old name VCUBE ID is now replaced with TENANT ID.</span>
                </P>
                <P>
                    <span>Clarified custom groups to designate Prod/NonProd groups separate from environment-specific groups.</span>
                </P>
                <P>
                    <span>Added designations in the LDAP structure as to which OUs are managed by the VCUBE Manager Portal and which are not, plus warnings as to what could go wrong if managed OUs are manipulated outside of the portal.</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P/>
            </Td>
            <Td>
                <P>
                    <span>1.6</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Corrected the OU=Apps,OU=Groups group name length.  It was incorrectly stated as 22 characters, it is now corrected to a maximum of 40 characters.</span>
                </P>
                <P>
                    <span>Added a reserved server type “l” for load balancer in the server naming conventions.</span>
                </P>
                <P>
                    <span>Added the ability to parameterize guest customization scripts per VM.  Added the ability to run provisioning customization scripts as a second round of guest customization.</span>
                    <span>  Documented the EMC OnDemand portal system and custom parameters available for use in provisioning scripts.</span>
                </P>
                <P>
                    <span>Filled out the section on VM Upgrades for Datacenter operating system, removal of old virus scanner, … .</span>
                </P>
                <P>
                    <span>Created a naming convention for vApps.  There was a lot of inconsistency in vApp names and vCloud Director has no naming policy enforcement.</span>
                </P>
            </Td>
        </Tr>
        <Tr>
            <Td>
                <P>
                    <span>9/7/12</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>1.7</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Todd Lauinger</span>
                </P>
            </Td>
            <Td>
                <P>
                    <span>Fixed some Active Directory group description issues.</span>
                </P>
                <P>
                    <span>Added details to the section on D: drives for optimized encryption.  When creating a D: drive, you must make sure you use an MBR type Windows disk partition.  GPT type partitions have the ability to grow beyond 2 GB but they greatly impair EMC backup technology (making backups take hours instead of minutes, not allowing file level restore).  So </span>
                    <span>we must use MBR type disk partitions</span>
                    <span> to integrate properly with our EMC backup systems.</span>
                </P>
                <P>
                    <span>Added information on the Pleasanton OnDemand lab.</span>
                </P>
            </Td>
        </Tr>
    </Table>
    <P/>
</HTML>
