<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="initial-scale=1.0, width=device-width, user-scalable=no"/>
		<meta name="HandheldFriendly" content="True" />
		<meta http-equiv="Content-type" content="text/html; charset=utf-8" />  
		<meta name="keywords" content="${keywords!}" />
		<title><#macro title>${titleContent!"Hi"}</#macro><@title/> - ${website.name}</title>
		<#noparse>
		<script>
			var 
			_l/*ocalStorage*/=localStorage,
			_c=function(key,tag){document.writeln('<'+tag+'>'+localStorage[key]+'</'+tag+'>')},
			_cf=function(k/*key*/,v/*ersion*/){_l[k]=window[k].innerHTML;document.cookie=k+"="+v+";path=/"}
		</script>
		</#noparse>
		<@link key="lungo" href="/res/lungo.css" rel="stylesheet"/>
		<@link key="lungo.icon" href="/res/lungo.icon.css" rel="stylesheet"/>
		<@link key="theme.lungo" href="/res/theme.lungo.css" rel="stylesheet"/>	
		<@link key="base" version="1.0">
			.unvisible{position:absolute;top:-1000px}
			section>header{border-radius:0;-webkit-border-radius:0}
			header nav input[type=text],footer nav input[type=text]{-webkit-user-select:auto!important;padding:10px; line-height:20px;}
			fieldset>legend{align:center}
			footer nav.groupbar{top:0px}
			footer nav.groupbar a{line-height:44px;height:44px!important}
			section > footer > nav > a.active{-webkit-box-shadow: inset 0 -3px 0 #0093d5;box-shadow: inset 0 -3px 0 #0093d5;}
			span.select{line-height:35px;}
			span.select>span{border:1px lightgray solid;border-left:none;background-color:lightyellow;padding:5px;cursor:default}
			span.select>span:hover{color:blue}
			span.select input:checked+span{background-color: blue}
			span.select>span:first-of-type{background-color:lightgreen;border-left:1px lightgray solid}
			#editor, .content{text-align:center}
			#editor span:empty:before{font-family:'lungojsicon';font-size:50px;font-weight:normal!important;content:"\0023"}
			#editor img, .content img{max-width:100%;}
			#editor img.current{border:2px solid blue}
			article{overflow:auto;margin-bottom:44px}		
		</@>
		<@script key="base" version="1.8.1">
			<#noparse>
			Array.prototype.each=NodeList.prototype.each=HTMLCollection.prototype.each=function(f){for(var i=0;i<this.length;i++) f(i,this[i]);return this};
			Node.prototype.remove=function(){this.parentNode.removeChild(this)};
			NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){this.each(function(i,a){a.remove()})};
			NodeList.prototype.last=HTMLCollection.prototype.last=function(){return this[this.length-1]}
			var
			$t/*emplate*/=function(k/*ey*/,d/*ata*/, f){(f||document.writeln).call(document,(k in $t&&$t[k]||($t[k]=Mustache.compile(k in this && this[k].innerHTML||_l[k])))(ontemplate(k,d)))},
			ontemplate=function(k,d){return d},
			$1=function(s/*elector*/,c/*ontext*/){return(c||document).querySelector(s)},
			$9=function(s,c){return(c||document).querySelectorAll(s)},
			e/*ncode*/=function(a){return a.replace(/[,\/\?\:@&=+\$#]/g,function(c){return '%'+(c+"").charCodeAt(0).toString(16)})},
			h/*tml*/=function(h/*tml*/,d,c){b=document;c=b.createElement("p");c.innerHTML=h;for(a=b.createDocumentFragment();b=c.firstChild;)a.appendChild(b);return a},
			_x=function(a){for(a=3;a--;)try{return new(XMLHttpRequest||ActiveXObject)(["Msxml2","Msxml3","Microsoft"][a]+".XMLHTTP")}catch(e){}},
			x=function(m/*ethod*/,u/*rl*/,c/*allback*/,d/*ata*/,x){with(x=_x())return (c&&(onreadystatechange=function(){readyState^4||status^200||c(this)})),open(m,u,c),send(d),x}
			</#noparse>
		</@>
		<#macro head></#macro><@head/>
	</head>
 	<body class="app ${path!'home'}">
		<@script key="mustache" src="/res/mustache.js"/>	
		<#macro content><@run contentMacroName!"_empty"/></#macro>
 		<#macro header><@run headerMacroName!"_empty"/></#macro>
 		<#macro footer><@run footerMacroName!"_empty"/></#macro>
 		<#macro aside><@run asideMacroName!"_empty"/></#macro>
 		<#macro body>
 			<section id="${path}_${contentMacroName!}" data-transition="slide">
				<@header/>
				<article id="${path}_${contentMacroName!}_1" class="active">
					<@content/>
				</article>
				<@footer/>
			</section>
			<@aside/>
			<@script key="quo" src="/res/quo.${debug}js"/>
			<@script key="lungo" src="/res/lungo.${debug}js" />
			<@script key="lungo.init"><#noparse>
				
				$9('.select input').each(function(i,el){
					el.nextSibling.addEventListener('click',function(){
						el.type=='checkbox'?(el.checked=!el.checked):(!el.checked && (el.checked=true))
						return false;
					})
				})
				
				Lungo.init({name:"home"})
				
				$9('#editor').each(function(i,el,a){
					$9('a',el).each(function(i,aEl){$1('section.show footer nav').insertAdjacentElement("afterbegin",aEl)})
					el.innerHTML=el.innerHTML.replace("p>","textarea>")
					el.add=function(){
						uploader.start(function(urls){
							if(urls.length==0)
								return;
							(a=$1('div>span',el)) && a.parentNode.remove()
							var current=$1('.current',el)
							if(current)
								current.insertAdjacentHTML("afterend",'<div><img src="'+urls[0]+'"><textarea></textarea></div>')
							else
								el.insertAdjacentHTML("beforeend",'<div><img src="'+urls[0]+'"><textarea></textarea></div>')
							$9('textarea',el).last().focus()
							for(var i=urls.length-1;i>0;i++)
								current.insertAdjacentHTML("afterend",'<div><img src="'+urls[i]+'"><textarea></textarea></div>')
							
						})
					}
					el.remove=function(){
						(a=$1('.current',el)) && a.parentNode.remove()
					}
					
					el.nextSibling.form.addEventListener('submit',function(){
						var content=[]
						$9('img',el).each(function(i,img){
							content.push('<div><img src="'+img.src+'"><p>'+img.nextSibling.value+'</p></div>')
						})
						el.nextSibling.value=content.join('')
					},false)
					
					el.addEventListener('click',function(e){
						if(e.srcElement.nodeName!="IMG" || 
							e.srcElement.classList.contains('current'))
							return
						(a=$1('.current',el)) && a.classList.remove('current')
						e.srcElement.classList.add('current')
					})
				})	
							
			</#noparse></@>
		</#macro><@body/>
	</body>
</html>
<#global outputed=true>