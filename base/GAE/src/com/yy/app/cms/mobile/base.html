<#--
show:
    -showList
        -action4List, filter4List
        -vote, authorInfo
    -show1 (show1Fields[, show1Extra])
    -showSerial
post:
    -postForm (postFields)
-->
<#macro init>
    <#assign this={"model":"post","path":path}>
</#macro>

<#macro showList>
	<#assign footerNavMacro='action4List' titleContent=this.model>
	<ol class="list">
		<#if count==0>
			<li><div  class="info">没有呢</div></li>
			<#return>
		<#else>
			<#list posts as post>
			<li class="arrow"><a href="/${path}/show/${post.ID}.shtml">${post.title}</a></li>
			</#list>
		</#if>
	</ol>

</#macro>

<#macro action4List>
	<a data-icon="plus" href="/${path}/create.html">创建</a>
	<a data-icon="search" href="/${path}/">查询</a>
</#macro>

<#macro show1>
	<#assign footerNavMacro={'name':'action41','arg':post}>
	<div>
		<h1>${post.title}</h1>
		<div><@authorInfo post.author/></div>
		<hr/>
		<div>${post.content}</div>
	</div>
	<@show1Extra post/>
</#macro>

<#macro show1Extra post>
</#macro>

<#macro action41 post>
	<@favoriteCMD post/>
	<a data-icon="pencil" href="/comment/list/${post.ID}.html"></a>
</#macro>

<#macro favoriteCMD post>
	<a data-icon="star" data-count="${post.favorites}" href="#"
		onclick="var a=this;x('get','/${path}/favorite/${post.ID}',function(x){$$('span',a).innerHTML=x.responseText})"></a>
</#macro>

<#macro postForm>
	<#assign footerNavMacro='postFooterNav' titleContent=titleContent+' '+this.model>
	<form action="/${path}/post" method="post" class="form">
		<input type="hidden" name="parent" value="${post.parent!0}">
        <input type="hidden" name="ID" value="${post.ID!0}">
        <@postFields post/>
	</form>
</#macro>

<#macro postFooterNav>
	<a data-icon="upload" href="#" onclick="document.querySelector('.active form').submit()">保存</a>
</#macro>

<#macro postFields post>
	<fieldset>
		<label>标题</label><br/>
		<input type="text" name="title" value="${post.title!}" required="required"/>
	</fieldset>
	
	<@postFieldContent post/>
	<#nested/>
	<fieldset>
		<label>标签</label><br/>
		<input type="text" placeholder="11个月,发烧" name="tag" value="${post.tag!}">
	</fieldset>
</#macro>

<#macro postFieldContent post>
	<fieldset>
		<label>内容</label><br/>
		<textarea name="content" required="required">${post.title!}</textarea>
	</fieldset>
</#macro>

<#macro authorInfo userID>
</#macro>
